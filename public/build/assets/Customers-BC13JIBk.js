import{j as e,a as D,b as xe,r as d,u as me}from"./app-9mFn5Lru.js";import{B as u}from"./button-BGM4I99h.js";import{a as pe,b as je,c as Ce,C as fe,d as ge}from"./card-DkGcV5mJ.js";import{P as Ne,C as be,a as ye,T as ve,D as T,b as E,c as F,d as A,e as M,f as P,t as z}from"./index-D3fCF_G-.js";import{X as Se,A as we}from"./AuthenticatedLayout-BLijZNZ5.js";import{I as N}from"./index-DKoFm-4Z.js";import{S as _e,a as ke,b as De,F as Te,c as Ee,d as Fe,e as Ae,C as Me,A as Pe}from"./select-CWEfNaLG.js";import{C as $}from"./calendar-DVYJ5bcW.js";import{T as b,a as m,B as Oe,b as Re,c as Be,d as k,e as Ue}from"./badge-CSS6k1K8.js";import{L as He}from"./label-7MXExJKb.js";/* empty css            */import"./index-a9231Ibs.js";import"./index-CJNFW_8h.js";const Ie=({onAddCustomer:s})=>e.jsx(pe,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(je,{className:"text-2xl font-bold",children:"Customers"}),e.jsx(Ce,{children:"Manage your customer database"})]}),e.jsxs(u,{onClick:s,className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4"})," Add Customer"]})]})}),Le=({searchTerm:s,setSearchTerm:r,selectedCountry:l,setSelectedCountry:o,checkinDateFilter:n,setCheckinDateFilter:c,checkoutDateFilter:h,setCheckoutDateFilter:p,clearFilters:j,countries:i})=>e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(_e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(N,{placeholder:"Search customers...",value:s,onChange:a=>r(a.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(ke,{value:l,onValueChange:o,children:[e.jsxs(De,{className:"w-full md:w-[180px]",children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),e.jsx(Ee,{placeholder:"Country"})]}),e.jsx(Fe,{children:i.map(a=>e.jsx(Ae,{value:a,children:a==="all"?"All Countries":a},a))})]}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(N,{type:"date",placeholder:"Check-in",value:n,onChange:a=>c(a.target.value),className:"pl-10 w-full"})]}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(N,{type:"date",placeholder:"Check-out",value:h,onChange:a=>p(a.target.value),className:"pl-10 w-full"})]}),e.jsxs(u,{variant:"outline",onClick:j,className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"})," Clear"]})]})]}),ze=({customer:s,isExpanded:r,onToggle:l,onEdit:o,onDelete:n,formatDate:c})=>e.jsxs(e.Fragment,{children:[e.jsxs(b,{className:"cursor-pointer hover:bg-muted/50",onClick:l,children:[e.jsx(m,{children:e.jsx(u,{variant:"ghost",size:"sm",children:r?e.jsx(Me,{className:"h-4 w-4"}):e.jsx(be,{className:"h-4 w-4"})})}),e.jsx(m,{className:"font-medium",children:s.name}),e.jsx(m,{children:s.email||"N/A"}),e.jsx(m,{children:s.phone||"N/A"}),e.jsx(m,{children:s.passport_country&&e.jsx(Oe,{variant:"outline",children:s.passport_country})}),e.jsx(m,{children:c(s.checkin_at)}),e.jsx(m,{children:c(s.checkout_at)}),e.jsx(m,{onClick:h=>h.stopPropagation(),children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{variant:"ghost",size:"sm",onClick:o,className:"bg-secondary text-secondary-foreground",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(u,{variant:"ghost",size:"sm",onClick:n,className:"bg-destructive text-destructive-foreground",children:e.jsx(ve,{className:"h-4 w-4"})})]})})]}),r&&e.jsx(b,{children:e.jsx(m,{colSpan:8,className:"p-4 bg-muted/20",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-1",children:"Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.notes||"No notes for this customer."})]})})},`${s.id}-details`)]}),$e=({customers:s,expandedRows:r,toggleRow:l,openEditModal:o,openDeleteModal:n,formatDate:c,sortBy:h,sortDirection:p,handleSort:j})=>{const i=({field:a,children:f})=>e.jsx(k,{className:"cursor-pointer",onClick:()=>j(a),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:f}),h===a&&e.jsx(Pe,{className:`h-3 w-3 ${p==="asc"?"rotate-180":""}`})]})});return e.jsx("div",{className:"rounded-md border",children:e.jsxs(Re,{children:[e.jsx(Be,{children:e.jsxs(b,{children:[e.jsx(k,{className:"w-8"}),e.jsx(i,{field:"name",children:"Name"}),e.jsx(i,{field:"email",children:"Email"}),e.jsx(i,{field:"phone",children:"Phone"}),e.jsx(i,{field:"passport_country",children:"Country"}),e.jsx(i,{field:"checkin_at",children:"Check-in"}),e.jsx(i,{field:"checkout_at",children:"Check-out"}),e.jsx(k,{children:"Actions"})]})}),e.jsx(Ue,{children:s.length>0?s.map(a=>e.jsx(ze,{customer:a,isExpanded:r.includes(a.id),onToggle:()=>l(a.id),onEdit:()=>o(a),onDelete:()=>n(a),formatDate:c},a.id)):e.jsx(b,{children:e.jsx(m,{colSpan:8,className:"text-center py-8",children:"No customers found"})})})]})})},V=({data:s,setData:r,errors:l})=>{const o=[{id:"name",label:"Name *",type:"text"},{id:"email",label:"Email",type:"email"},{id:"phone",label:"Phone",type:"text"},{id:"passport_country",label:"Country",type:"text"},{id:"checkin_at",label:"Check-in",type:"date"},{id:"checkout_at",label:"Check-out",type:"date"},{id:"notes",label:"Notes",type:"text"}];return e.jsx("div",{className:"grid gap-4 py-4",children:o.map(n=>e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(He,{htmlFor:n.id,className:"text-right",children:n.label}),e.jsx(N,{id:n.id,type:n.type,value:s[n.id]||"",onChange:c=>r(n.id,c.target.value),className:"col-span-3"}),l[n.id]&&e.jsx("p",{className:"text-red-500 text-sm col-span-4 text-right",children:l[n.id]})]},n.id))})},Ve=({isOpen:s,onOpenChange:r,onConfirm:l,customer:o})=>o?e.jsx(T,{open:s,onOpenChange:r,children:e.jsxs(E,{children:[e.jsxs(F,{children:[e.jsx(A,{children:"Confirm Deletion"}),e.jsxs(M,{children:["Are you sure you want to delete ",e.jsx("strong",{children:o.name}),"? This action cannot be undone."]})]}),e.jsxs(P,{children:[e.jsx(u,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(u,{variant:"destructive",onClick:l,children:"Delete"})]})]})}):null,qe=({paginationData:s,buildPaginationUrl:r})=>{const{from:l,to:o,total:n,prev_page_url:c,next_page_url:h,current_page:p}=s,j=i=>{i&&D.get(r(i),{},{preserveState:!0,replace:!0})};return e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",l," to ",o," of ",n," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>j(c),disabled:!c,children:"Previous"}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>j(h),disabled:!h,children:"Next"})]})]})};function Xe(){const{customers:s,filters:r,flash:l}=xe().props,[o,n]=d.useState(r.search||""),[c,h]=d.useState(r.passport_country||"all"),[p,j]=d.useState(r.checkin_date||""),[i,a]=d.useState(r.checkout_date||""),[f,O]=d.useState(r.sort_by||"created_at"),[g,R]=d.useState(r.sort_direction||"desc"),[q,y]=d.useState(!1),[X,v]=d.useState(!1),[G,S]=d.useState(!1),[w,B]=d.useState(null),[J,K]=d.useState(["all"]),[Q,W]=d.useState([]),{data:U,setData:_,post:Y,put:Z,processing:H,errors:I,reset:ee,clearErrors:L}=me({name:"",email:"",phone:"",passport_country:"",checkin_at:"",checkout_at:"",notes:""});d.useEffect(()=>{const t=[...new Set(s.data.map(x=>x.passport_country).filter(Boolean))];K(["all",...t])},[s]),d.useEffect(()=>{l?.success&&z.success(l.success),l?.error&&z.error(l.error)},[l]),d.useEffect(()=>{const t=setTimeout(()=>se(1),500);return()=>clearTimeout(t)},[o,c,p,i,f,g]);const se=(t=r.page||1)=>{D.get(route("customers.index"),{search:o,passport_country:c==="all"?"":c,checkin_date:p,checkout_date:i,sort_by:f,sort_direction:g,page:t},{preserveState:!0,replace:!0})},te=t=>{O(t),R(x=>x==="asc"?"desc":"asc")},ae=()=>{ee(),L(),y(!0)},re=t=>{_({...t}),L(),B(t),v(!0)},ne=t=>{B(t),S(!0)},le=t=>{t.preventDefault(),Y(route("customers.store"),{onSuccess:()=>y(!1)})},ce=t=>{t.preventDefault(),Z(route("customers.update",w.id),{onSuccess:()=>v(!1)})},oe=()=>{D.delete(route("customers.destroy",w.id),{onSuccess:()=>S(!1)})},ie=()=>{n(""),h("all"),j(""),a(""),O("created_at"),R("desc")},de=t=>t?new Date(t).toLocaleDateString():"N/A",he=t=>W(x=>x.includes(t)?x.filter(C=>C!==t):[...x,t]),ue=t=>{if(!t)return null;const x=new URL(t),C=new URLSearchParams(x.search);return C.set("search",o),C.set("passport_country",c==="all"?"":c),C.set("checkin_date",p),C.set("checkout_date",i),C.set("sort_by",f),C.set("sort_direction",g),`${x.pathname}?${C.toString()}`};return e.jsxs("div",{className:"container mx-auto py-2 px-4",children:[e.jsxs(fe,{className:"mb-8",children:[e.jsx(Ie,{onAddCustomer:ae}),e.jsxs(ge,{children:[e.jsx(Le,{searchTerm:o,setSearchTerm:n,selectedCountry:c,setSelectedCountry:h,checkinDateFilter:p,setCheckinDateFilter:j,checkoutDateFilter:i,setCheckoutDateFilter:a,clearFilters:ie,countries:J}),e.jsx($e,{customers:s.data,expandedRows:Q,toggleRow:he,openEditModal:re,openDeleteModal:ne,formatDate:de,sortBy:f,sortDirection:g,handleSort:te}),e.jsx(qe,{paginationData:s,buildPaginationUrl:ue})]})]}),e.jsx(T,{open:q,onOpenChange:y,children:e.jsxs(E,{className:"sm:max-w-[425px]",children:[e.jsxs(F,{children:[e.jsx(A,{children:"Create New Customer"}),e.jsx(M,{children:"Add a new customer to your database"})]}),e.jsxs("form",{onSubmit:le,children:[e.jsx(V,{data:U,setData:_,errors:I}),e.jsx(P,{children:e.jsx(u,{type:"submit",disabled:H,children:"Create Customer"})})]})]})}),e.jsx(T,{open:X,onOpenChange:v,children:e.jsxs(E,{className:"sm:max-w-[425px]",children:[e.jsxs(F,{children:[e.jsx(A,{children:"Edit Customer"}),e.jsx(M,{children:"Update customer information"})]}),e.jsxs("form",{onSubmit:ce,children:[e.jsx(V,{data:U,setData:_,errors:I}),e.jsx(P,{children:e.jsx(u,{type:"submit",disabled:H,children:"Update Customer"})})]})]})}),e.jsx(Ve,{isOpen:G,onOpenChange:S,onConfirm:oe,customer:w})]})}Xe.layout=s=>e.jsx(we,{children:s});export{Xe as default};
