import{j as e,a as D,b as xe,r as d,u as me}from"./app-DAksNdPr.js";import{B as u}from"./createLucideIcon-CDjEx02q.js";import{C as pe,a as je,b as Ce,T as b,c as m,B as fe,d as ge,e as Ne,f as _,g as be,h as ye,i as ve}from"./badge-DqFlTVMn.js";import{P as Se,S as we,a as ke,b as _e,F as De,c as Te,d as Ee,e as Fe,C as Ae,f as Me,g as Pe,T as Oe,A as Re,D as T,h as E,i as F,j as A,k as M,l as P,t as z}from"./select-CynGadpL.js";import{X as Be,A as Ue}from"./AuthenticatedLayout-otVu2RNG.js";import{I as N,L as He}from"./check-BwVF50uz.js";import{C as $}from"./calendar-_nwj3QhV.js";/* empty css            */import"./index-Bfs2tR1_.js";import"./index-CF1EjuT2.js";const Ie=({onAddCustomer:s})=>e.jsx(pe,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(je,{className:"text-2xl font-bold",children:"Customers"}),e.jsx(Ce,{children:"Manage your customer database"})]}),e.jsxs(u,{onClick:s,className:"flex items-center gap-2",children:[e.jsx(Se,{className:"h-4 w-4"})," Add Customer"]})]})}),Le=({searchTerm:s,setSearchTerm:r,selectedCountry:n,setSelectedCountry:o,checkinDateFilter:l,setCheckinDateFilter:c,checkoutDateFilter:h,setCheckoutDateFilter:p,clearFilters:j,countries:i})=>e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(we,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(N,{placeholder:"Search customers...",value:s,onChange:a=>r(a.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(ke,{value:n,onValueChange:o,children:[e.jsxs(_e,{className:"w-full md:w-[180px]",children:[e.jsx(De,{className:"mr-2 h-4 w-4"}),e.jsx(Te,{placeholder:"Country"})]}),e.jsx(Ee,{children:i.map(a=>e.jsx(Fe,{value:a,children:a==="all"?"All Countries":a},a))})]}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(N,{type:"date",placeholder:"Check-in",value:l,onChange:a=>c(a.target.value),className:"pl-10 w-full"})]}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(N,{type:"date",placeholder:"Check-out",value:h,onChange:a=>p(a.target.value),className:"pl-10 w-full"})]}),e.jsxs(u,{variant:"outline",onClick:j,className:"flex items-center gap-2",children:[e.jsx(Be,{className:"h-4 w-4"})," Clear"]})]})]}),ze=({customer:s,isExpanded:r,onToggle:n,onEdit:o,onDelete:l,formatDate:c})=>e.jsxs(e.Fragment,{children:[e.jsxs(b,{className:"cursor-pointer hover:bg-muted/50",onClick:n,children:[e.jsx(m,{children:e.jsx(u,{variant:"ghost",size:"sm",children:r?e.jsx(Ae,{className:"h-4 w-4"}):e.jsx(Me,{className:"h-4 w-4"})})}),e.jsx(m,{className:"font-medium",children:s.name}),e.jsx(m,{children:s.email||"N/A"}),e.jsx(m,{children:s.phone||"N/A"}),e.jsx(m,{children:s.passport_country&&e.jsx(fe,{variant:"outline",children:s.passport_country})}),e.jsx(m,{children:c(s.checkin_at)}),e.jsx(m,{children:c(s.checkout_at)}),e.jsx(m,{onClick:h=>h.stopPropagation(),children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{variant:"ghost",size:"sm",onClick:o,children:e.jsx(Pe,{className:"h-4 w-4"})}),e.jsx(u,{variant:"ghost",size:"sm",onClick:l,children:e.jsx(Oe,{className:"h-4 w-4"})})]})})]}),r&&e.jsx(b,{children:e.jsx(m,{colSpan:8,className:"p-4 bg-muted/20",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-sm mb-1",children:"Notes"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.notes||"No notes for this customer."})]})})},`${s.id}-details`)]}),$e=({customers:s,expandedRows:r,toggleRow:n,openEditModal:o,openDeleteModal:l,formatDate:c,sortBy:h,sortDirection:p,handleSort:j})=>{const i=({field:a,children:f})=>e.jsx(_,{className:"cursor-pointer",onClick:()=>j(a),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:f}),h===a&&e.jsx(Re,{className:`h-3 w-3 ${p==="asc"?"rotate-180":""}`})]})});return e.jsx("div",{className:"rounded-md border",children:e.jsxs(ge,{children:[e.jsx(Ne,{children:e.jsxs(b,{children:[e.jsx(_,{className:"w-8"}),e.jsx(i,{field:"name",children:"Name"}),e.jsx(i,{field:"email",children:"Email"}),e.jsx(i,{field:"phone",children:"Phone"}),e.jsx(i,{field:"passport_country",children:"Country"}),e.jsx(i,{field:"checkin_at",children:"Check-in"}),e.jsx(i,{field:"checkout_at",children:"Check-out"}),e.jsx(_,{children:"Actions"})]})}),e.jsx(be,{children:s.length>0?s.map(a=>e.jsx(ze,{customer:a,isExpanded:r.includes(a.id),onToggle:()=>n(a.id),onEdit:()=>o(a),onDelete:()=>l(a),formatDate:c},a.id)):e.jsx(b,{children:e.jsx(m,{colSpan:8,className:"text-center py-8",children:"No customers found"})})})]})})},V=({data:s,setData:r,errors:n})=>{const o=[{id:"name",label:"Name *",type:"text"},{id:"email",label:"Email",type:"email"},{id:"phone",label:"Phone",type:"text"},{id:"passport_country",label:"Country",type:"text"},{id:"checkin_at",label:"Check-in",type:"date"},{id:"checkout_at",label:"Check-out",type:"date"},{id:"notes",label:"Notes",type:"text"}];return e.jsx("div",{className:"grid gap-4 py-4",children:o.map(l=>e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(He,{htmlFor:l.id,className:"text-right",children:l.label}),e.jsx(N,{id:l.id,type:l.type,value:s[l.id]||"",onChange:c=>r(l.id,c.target.value),className:"col-span-3"}),n[l.id]&&e.jsx("p",{className:"text-red-500 text-sm col-span-4 text-right",children:n[l.id]})]},l.id))})},Ve=({isOpen:s,onOpenChange:r,onConfirm:n,customer:o})=>o?e.jsx(T,{open:s,onOpenChange:r,children:e.jsxs(E,{children:[e.jsxs(F,{children:[e.jsx(A,{children:"Confirm Deletion"}),e.jsxs(M,{children:["Are you sure you want to delete ",e.jsx("strong",{children:o.name}),"? This action cannot be undone."]})]}),e.jsxs(P,{children:[e.jsx(u,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(u,{variant:"destructive",onClick:n,children:"Delete"})]})]})}):null,qe=({paginationData:s,buildPaginationUrl:r})=>{const{from:n,to:o,total:l,prev_page_url:c,next_page_url:h,current_page:p}=s,j=i=>{i&&D.get(r(i),{},{preserveState:!0,replace:!0})};return e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",n," to ",o," of ",l," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{variant:"outline",size:"sm",onClick:()=>j(c),disabled:!c,children:"Previous"}),e.jsx(u,{variant:"outline",size:"sm",onClick:()=>j(h),disabled:!h,children:"Next"})]})]})};function Xe(){const{customers:s,filters:r,flash:n}=xe().props,[o,l]=d.useState(r.search||""),[c,h]=d.useState(r.passport_country||"all"),[p,j]=d.useState(r.checkin_date||""),[i,a]=d.useState(r.checkout_date||""),[f,O]=d.useState(r.sort_by||"created_at"),[g,R]=d.useState(r.sort_direction||"desc"),[q,y]=d.useState(!1),[X,v]=d.useState(!1),[G,S]=d.useState(!1),[w,B]=d.useState(null),[J,K]=d.useState(["all"]),[Q,W]=d.useState([]),{data:U,setData:k,post:Y,put:Z,processing:H,errors:I,reset:ee,clearErrors:L}=me({name:"",email:"",phone:"",passport_country:"",checkin_at:"",checkout_at:"",notes:""});d.useEffect(()=>{const t=[...new Set(s.data.map(x=>x.passport_country).filter(Boolean))];K(["all",...t])},[s]),d.useEffect(()=>{n?.success&&z.success(n.success),n?.error&&z.error(n.error)},[n]),d.useEffect(()=>{const t=setTimeout(()=>se(1),500);return()=>clearTimeout(t)},[o,c,p,i,f,g]);const se=(t=r.page||1)=>{D.get(route("customers.index"),{search:o,passport_country:c==="all"?"":c,checkin_date:p,checkout_date:i,sort_by:f,sort_direction:g,page:t},{preserveState:!0,replace:!0})},te=t=>{O(t),R(x=>x==="asc"?"desc":"asc")},ae=()=>{ee(),L(),y(!0)},re=t=>{k({...t}),L(),B(t),v(!0)},le=t=>{B(t),S(!0)},ne=t=>{t.preventDefault(),Y(route("customers.store"),{onSuccess:()=>y(!1)})},ce=t=>{t.preventDefault(),Z(route("customers.update",w.id),{onSuccess:()=>v(!1)})},oe=()=>{D.delete(route("customers.destroy",w.id),{onSuccess:()=>S(!1)})},ie=()=>{l(""),h("all"),j(""),a(""),O("created_at"),R("desc")},de=t=>t?new Date(t).toLocaleDateString():"N/A",he=t=>W(x=>x.includes(t)?x.filter(C=>C!==t):[...x,t]),ue=t=>{if(!t)return null;const x=new URL(t),C=new URLSearchParams(x.search);return C.set("search",o),C.set("passport_country",c==="all"?"":c),C.set("checkin_date",p),C.set("checkout_date",i),C.set("sort_by",f),C.set("sort_direction",g),`${x.pathname}?${C.toString()}`};return e.jsxs("div",{className:"container mx-auto py-2 px-4",children:[e.jsxs(ye,{className:"mb-8",children:[e.jsx(Ie,{onAddCustomer:ae}),e.jsxs(ve,{children:[e.jsx(Le,{searchTerm:o,setSearchTerm:l,selectedCountry:c,setSelectedCountry:h,checkinDateFilter:p,setCheckinDateFilter:j,checkoutDateFilter:i,setCheckoutDateFilter:a,clearFilters:ie,countries:J}),e.jsx($e,{customers:s.data,expandedRows:Q,toggleRow:he,openEditModal:re,openDeleteModal:le,formatDate:de,sortBy:f,sortDirection:g,handleSort:te}),e.jsx(qe,{paginationData:s,buildPaginationUrl:ue})]})]}),e.jsx(T,{open:q,onOpenChange:y,children:e.jsxs(E,{className:"sm:max-w-[425px]",children:[e.jsxs(F,{children:[e.jsx(A,{children:"Create New Customer"}),e.jsx(M,{children:"Add a new customer to your database"})]}),e.jsxs("form",{onSubmit:ne,children:[e.jsx(V,{data:U,setData:k,errors:I}),e.jsx(P,{children:e.jsx(u,{type:"submit",disabled:H,children:"Create Customer"})})]})]})}),e.jsx(T,{open:X,onOpenChange:v,children:e.jsxs(E,{className:"sm:max-w-[425px]",children:[e.jsxs(F,{children:[e.jsx(A,{children:"Edit Customer"}),e.jsx(M,{children:"Update customer information"})]}),e.jsxs("form",{onSubmit:ce,children:[e.jsx(V,{data:U,setData:k,errors:I}),e.jsx(P,{children:e.jsx(u,{type:"submit",disabled:H,children:"Update Customer"})})]})]})}),e.jsx(Ve,{isOpen:G,onOpenChange:S,onConfirm:oe,customer:w})]})}Xe.layout=s=>e.jsx(Ue,{children:s});export{Xe as default};
