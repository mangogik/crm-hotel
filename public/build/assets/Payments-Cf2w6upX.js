import{j as e,b as _,c as Ne,r as m,u as be}from"./app-DyCqJnq8.js";import{d as ye,f as A,A as we}from"./AuthenticatedLayout-DwKmPWVe.js";import{P as Ce,T as Se,t as $}from"./index-Dmz9vWGP.js";import{b as V,c as _e,C as L,a as De,d as O}from"./card-DfsM1uHZ.js";import{B as E}from"./badge-Dr67Kl6N.js";import{S as Pe,a as D,b as P,c as k,d as I,e as i,C as ke,A as Ie,D as X,g as G,h as J,i as K,j as Q,k as Te}from"./select-C-U1P8b2.js";import{D as Me}from"./dollar-sign-CWvCsFxG.js";import{C as W}from"./calendar-C3GyG3-q.js";import{c as z,B as p}from"./button-D06_44sF.js";import{I as U,L as q}from"./index-BrgHgUOb.js";import{T,a as f,b as Re,c as Fe,d as C,e as Ae}from"./table-CQARLqB7.js";/* empty css            */import"./index-B8SPxhOw.js";import"./index-D4gjlerK.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Le=z("circle-x",Ee);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],ze=z("external-link",Oe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],He=z("refresh-cw",Be),S=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s||0),$e=({totals:s})=>{const a=[{title:"Paid Amount",value:S(s?.paid),icon:Me,color:"text-green-600",bgColor:"bg-green-100",borderColor:"border-green-200"},{title:"Pending Amount",value:S(s?.pending),icon:W,color:"text-amber-600",bgColor:"bg-amber-100",borderColor:"border-amber-200"},{title:"Failed Amount",value:S(s?.failed),icon:Le,color:"text-red-600",bgColor:"bg-red-100",borderColor:"border-red-200"},{title:"Refunded Amount",value:S(s?.refunded),icon:He,color:"text-purple-600",bgColor:"bg-purple-100",borderColor:"border-purple-200"}];return e.jsxs("div",{className:"pb-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx(V,{className:"text-2xl font-bold",children:"Payments"}),e.jsx(_e,{children:"Monitor and reconcile all transactions"})]})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 pt-6",children:a.map((r,l)=>e.jsxs(L,{className:`p-2 gap-1 border-b-8 ${r.borderColor}`,children:[e.jsxs(De,{className:"flex flex-row items-center justify-between p-2",children:[e.jsx(V,{className:"text-sm font-medium text-muted-foreground",children:r.title}),e.jsx("div",{className:`rounded-full p-1 border-2 ${r.bgColor}`,children:e.jsx(r.icon,{className:`h-4 w-4 ${r.color}`})})]}),e.jsx(O,{className:"px-2",children:e.jsx("div",{className:"text-2xl font-bold",children:r.value})})]},l))})]})},Ve=({search:s,setSearch:a,status:r,setStatus:l,method:c,setMethod:g,dateRange:o,setDateRange:v,clearFilters:x})=>e.jsx(L,{className:"mb-6",children:e.jsx(O,{children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(U,{placeholder:"Search by customer, email, phone, or payment ID...",value:s,onChange:h=>a(h.target.value),className:"w-full pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(D,{value:r,onValueChange:l,children:[e.jsx(P,{className:"w-[160px]",children:e.jsx(k,{placeholder:"Status"})}),e.jsxs(I,{children:[e.jsx(i,{value:"all",children:"All Status"}),e.jsx(i,{value:"pending",children:"Pending"}),e.jsx(i,{value:"paid",children:"Paid"}),e.jsx(i,{value:"failed",children:"Failed"}),e.jsx(i,{value:"refunded",children:"Refunded"})]})]}),e.jsxs(D,{value:c,onValueChange:g,children:[e.jsx(P,{className:"w-[150px]",children:e.jsx(k,{placeholder:"Method"})}),e.jsxs(I,{children:[e.jsx(i,{value:"all",children:"All Methods"}),e.jsx(i,{value:"cash",children:"Cash"}),e.jsx(i,{value:"online",children:"Online"})]})]}),e.jsx(U,{type:"date",value:o,onChange:h=>v(h.target.value),className:"w-auto"}),e.jsx(p,{variant:"outline",onClick:x,children:"Clear"})]})]})})}),Ue=({payment:s,isExpanded:a,onToggle:r,onEdit:l,onDelete:c,getStatusBadge:g,getMethodBadge:o,formatPrice:v,formatDate:x,formatDateTime:h})=>e.jsxs(e.Fragment,{children:[e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:r,children:[e.jsx(f,{className:"w-12",children:e.jsx(p,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:a?e.jsx(ke,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:e.jsx(A,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.order?.customer?.name||"Unknown"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.order?.customer?.email||"No email"})]})]})}),e.jsx(f,{children:s.order?.customer?.passport_country?e.jsx(E,{variant:"outline",className:"text-xs",children:s.order.customer.passport_country}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"N/A"})}),e.jsx(f,{children:g(s.status)}),e.jsx(f,{children:o(s.method)}),e.jsx(f,{children:e.jsx("div",{className:"font-semibold",children:v(s.amount)})}),e.jsx(f,{children:e.jsx("div",{className:"text-sm",children:x(s.created_at)})}),e.jsx(f,{onClick:u=>u.stopPropagation(),children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>l(s),className:"bg-secondary text-secondary-foreground",children:e.jsx(Ce,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>c(s),className:"bg-destructive text-destructive-foreground",children:e.jsx(Se,{className:"h-4 w-4"})})]})})]}),a&&e.jsx(T,{children:e.jsx(f,{colSpan:8,className:"p-0",children:e.jsx("div",{className:"bg-muted/20 p-4 border-b",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-20",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"})," ","Payment Details"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"External ID:"}),e.jsx("span",{className:"font-mono",children:s.external_id||"—"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Invoice ID:"}),e.jsx("span",{className:"font-mono",children:s.invoice_id||"—"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Paid At:"}),e.jsx("span",{children:h(s.paid_at)})]}),s.payment_url&&e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsx("span",{className:"text-muted-foreground",children:"Invoice:"}),e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>window.open(s.payment_url,"_blank"),className:"text-blue-600 hover:text-blue-700",children:[e.jsx(ze,{className:"h-4 w-4 mr-1"})," ","View Invoice"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4"})," Order Details"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Order ID:"}),e.jsx("span",{className:"font-mono",children:s.order?.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Order Date:"}),e.jsx("span",{children:h(s.order?.created_at)})]})]})]})]})})})})]}),qe=({payments:s,expandedRows:a,toggleRow:r,onEdit:l,onDelete:c,getStatusBadge:g,getMethodBadge:o,formatPrice:v,formatDate:x,formatDateTime:h,sortBy:u,sortDirection:w,handleSort:b})=>{const N=({field:d,children:y})=>e.jsx(C,{className:"cursor-pointer",onClick:()=>b(d),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:y}),u===d&&e.jsx(Ie,{className:`h-3 w-3 ${w==="asc"?"rotate-180":""}`})]})});return e.jsx("div",{className:"rounded-md border",children:e.jsxs(Re,{children:[e.jsx(Fe,{children:e.jsxs(T,{children:[e.jsx(C,{className:"w-12"}),e.jsx(N,{field:"order.customer.name",children:"Customer"}),e.jsx(C,{children:"Country"}),e.jsx(N,{field:"status",children:"Status"}),e.jsx(N,{field:"method",children:"Method"}),e.jsx(N,{field:"amount",children:"Amount"}),e.jsx(N,{field:"created_at",children:"Date"}),e.jsx(C,{children:"Actions"})]})}),e.jsx(Ae,{children:s?.length?s.map(d=>e.jsx(Ue,{payment:d,isExpanded:a.includes(d.id),onToggle:()=>r(d.id),onEdit:l,onDelete:c,getStatusBadge:g,getMethodBadge:o,formatPrice:v,formatDate:x,formatDateTime:h},d.id)):e.jsx(T,{children:e.jsx(f,{colSpan:8,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground",children:[e.jsx(A,{className:"h-12 w-12 mb-2"}),e.jsx("p",{children:"No payments found"})]})})})})]})})},Xe=({data:s,setData:a,onSubmit:r,processing:l})=>e.jsxs("form",{onSubmit:r,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(q,{htmlFor:"edit_method",className:"text-right",children:"Method"}),e.jsxs(D,{value:s.method,onValueChange:c=>a("method",c),children:[e.jsx(P,{className:"col-span-3",children:e.jsx(k,{placeholder:"Select method"})}),e.jsxs(I,{children:[e.jsx(i,{value:"cash",children:"Cash"}),e.jsx(i,{value:"online",children:"Online"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(q,{htmlFor:"edit_status",className:"text-right",children:"Status"}),e.jsxs(D,{value:s.status,onValueChange:c=>a("status",c),children:[e.jsx(P,{className:"col-span-3",children:e.jsx(k,{placeholder:"Select status"})}),e.jsxs(I,{children:[e.jsx(i,{value:"pending",children:"Pending"}),e.jsx(i,{value:"paid",children:"Paid"}),e.jsx(i,{value:"failed",children:"Failed"}),e.jsx(i,{value:"refunded",children:"Refunded"})]})]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(p,{type:"submit",disabled:l,children:"Save Changes"})})]}),Ge=({paginationData:s,buildPaginationUrl:a})=>{const r=l=>{l&&_.get(a(l),{},{preserveState:!0,replace:!0})};return e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",s?.from," to ",s?.to," of ",s?.total," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>r(s.prev_page_url),disabled:!s?.prev_page_url,children:"Previous"}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>r(s.next_page_url),disabled:!s?.next_page_url,children:"Next"})]})]})},Je=({isOpen:s,onOpenChange:a,onConfirm:r,payment:l})=>l?e.jsx(X,{open:s,onOpenChange:a,children:e.jsxs(G,{children:[e.jsxs(J,{children:[e.jsx(K,{children:"Confirm Deletion"}),e.jsx(Q,{children:"Are you sure you want to delete this payment? This action cannot be undone."})]}),e.jsxs(Te,{children:[e.jsx(p,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(p,{variant:"destructive",onClick:r,children:"Delete"})]})]})}):null;function Ke(){const{payments:s,filters:a,totals:r,flash:l}=Ne().props,[c,g]=m.useState(a?.search||""),[o,v]=m.useState(a?.status||"all"),[x,h]=m.useState(a?.method||"all"),[u,w]=m.useState(a?.date_from||""),[b,N]=m.useState(a?.sort_by||"created_at"),[d,y]=m.useState(a?.sort_direction||"desc"),[Y,Z]=m.useState([]),[ee,M]=m.useState(!1),[se,R]=m.useState(!1),[F,B]=m.useState(null),{data:te,setData:H,put:ae,processing:re,reset:le}=be({method:"",notes:"",status:"pending"});m.useEffect(()=>{l?.success&&$.success(l.success),l?.error&&$.error(l.error)},[l]),m.useEffect(()=>{const t=setTimeout(()=>ne(1),500);return()=>clearTimeout(t)},[c,o,x,u,b,d]);const ne=(t=1)=>{_.get(route("payments.index"),{search:c,status:o==="all"?"":o,method:x==="all"?"":x,date_from:u||"",date_to:u||"",sort_by:b,sort_direction:d,page:t},{preserveState:!0,replace:!0})},ce=t=>{b===t?y(d==="asc"?"desc":"asc"):(N(t),y("asc"))},ie=()=>{g(""),v("all"),h("all"),w(""),N("created_at"),y("desc")},de=t=>{if(!t)return null;const n=new URL(t),j=new URLSearchParams(n.search);return j.set("search",c),j.set("status",o==="all"?"":o),j.set("method",x==="all"?"":x),j.set("date_from",u||""),j.set("date_to",u||""),j.set("sort_by",b),j.set("sort_direction",d),`${n.pathname}?${j.toString()}`},oe=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t||0),xe=t=>t?new Date(t).toLocaleDateString():"—",me=t=>t?new Date(t).toLocaleString():"—",he=t=>{let n="secondary";return t==="pending"?n="warning":t==="paid"?n="success":t==="failed"?n="destructive":t==="refunded"&&(n="purple"),e.jsx(E,{variant:n,className:"capitalize px-3 py-1 text-xs font-medium w-20 justify-center",children:t})},ue=t=>{let n="outline";return t==="cash"?n="purple":t==="online"&&(n="info"),e.jsx(E,{variant:n,className:"capitalize px-3 py-1 text-xs font-medium w-20 justify-center",children:t||"—"})},je=t=>Z(n=>n.includes(t)?n.filter(j=>j!==t):[...n,t]),fe=t=>{B(t),H({method:t.method,notes:t.notes||"",status:t.status}),M(!0)},pe=t=>{B(t),R(!0)},ge=t=>{t.preventDefault(),ae(route("payments.update",F.id),{onSuccess:()=>{M(!1),le()}})},ve=()=>{_.delete(route("payments.destroy",F.id),{preserveState:!0,onSuccess:()=>{R(!1)}})};return e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx($e,{totals:r}),e.jsx(L,{children:e.jsxs(O,{className:"pt-0",children:[e.jsx(Ve,{search:c,setSearch:g,status:o,setStatus:v,method:x,setMethod:h,dateRange:u,setDateRange:w,clearFilters:ie}),e.jsx(qe,{payments:s.data,expandedRows:Y,toggleRow:je,onEdit:fe,onDelete:pe,getStatusBadge:he,getMethodBadge:ue,formatPrice:oe,formatDate:xe,formatDateTime:me,sortBy:b,sortDirection:d,handleSort:ce}),e.jsx(Ge,{paginationData:s,buildPaginationUrl:de,router:_})]})}),e.jsx(X,{open:ee,onOpenChange:M,children:e.jsxs(G,{className:"sm:max-w-[425px]",children:[e.jsxs(J,{children:[e.jsx(K,{children:"Edit Payment"}),e.jsx(Q,{children:"Update payment details and change status if needed."})]}),e.jsx(Xe,{data:te,setData:H,onSubmit:ge,processing:re})]})}),e.jsx(Je,{isOpen:se,onOpenChange:R,onConfirm:ve,payment:F})]})}Ke.layout=s=>e.jsx(we,{children:s});export{Ke as default};
