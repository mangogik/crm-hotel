import{j as e,b as _,c as Ne,r as x,u as be}from"./app-DJl2ydn2.js";import{d as ye,f as E,A as Ce}from"./AuthenticatedLayout-C8pa3ZP2.js";import{P as we,T as Se,t as H}from"./index-CT-tMDo4.js";import{b as $,c as _e,C as L,a as De,d as O}from"./card-q4U6RwoP.js";import{B as M}from"./badge-M-ee0RcM.js";import{S as Pe,A as Te,D as q,b as X,c as G,d as J,e as K,f as Ie}from"./dialog-CeYiyMWA.js";import{D as Re}from"./dollar-sign-BIrAnHgN.js";import{C as Q}from"./calendar-C9Ih-5se.js";import{c as W,B as p}from"./button-BcKuhJzw.js";import{I as U}from"./input-ksvuRPG_.js";import{S as D,a as P,b as T,c as I,d as i}from"./select-D32KVn18.js";import{T as R,a as f,b as ke,c as Fe,d as w,e as Ae}from"./table-C82BmRIm.js";import{C as Ee}from"./chevron-down-lmp7wB3O.js";import{E as Me}from"./external-link-CCXr0jUV.js";import{L as V}from"./label-xh0tx8M8.js";/* empty css            */import"./index-DjLYN8p0.js";import"./index-CNtyiCxP.js";import"./index-2z52CgDs.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Oe=W("circle-x",Le);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Be=W("refresh-cw",ze),S=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s||0),He=({totals:s})=>{const a=[{title:"Paid Amount",value:S(s?.paid),icon:Re,color:"text-green-600",bgColor:"bg-green-100",borderColor:"border-green-200"},{title:"Pending Amount",value:S(s?.pending),icon:Q,color:"text-amber-600",bgColor:"bg-amber-100",borderColor:"border-amber-200"},{title:"Failed Amount",value:S(s?.failed),icon:Oe,color:"text-red-600",bgColor:"bg-red-100",borderColor:"border-red-200"},{title:"Refunded Amount",value:S(s?.refunded),icon:Be,color:"text-purple-600",bgColor:"bg-purple-100",borderColor:"border-purple-200"}];return e.jsxs("div",{className:"pb-4",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx($,{className:"text-2xl font-bold",children:"Payments"}),e.jsx(_e,{children:"Monitor and reconcile all transactions"})]})}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 pt-6",children:a.map((r,l)=>e.jsxs(L,{className:`p-2 gap-1 border-b-8 ${r.borderColor}`,children:[e.jsxs(De,{className:"flex flex-row items-center justify-between p-2",children:[e.jsx($,{className:"text-sm font-medium text-muted-foreground",children:r.title}),e.jsx("div",{className:`rounded-full p-1 border-2 ${r.bgColor}`,children:e.jsx(r.icon,{className:`h-4 w-4 ${r.color}`})})]}),e.jsx(O,{className:"px-2",children:e.jsx("div",{className:"text-2xl font-bold",children:r.value})})]},l))})]})},$e=({search:s,setSearch:a,status:r,setStatus:l,method:c,setMethod:g,dateRange:o,setDateRange:v,clearFilters:m})=>e.jsx(L,{className:"mb-6",children:e.jsx(O,{children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),e.jsx(U,{placeholder:"Search by customer, email, phone, or payment ID...",value:s,onChange:u=>a(u.target.value),className:"w-full pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(D,{value:r,onValueChange:l,children:[e.jsx(P,{className:"w-[160px]",children:e.jsx(T,{placeholder:"Status"})}),e.jsxs(I,{children:[e.jsx(i,{value:"all",children:"All Status"}),e.jsx(i,{value:"pending",children:"Pending"}),e.jsx(i,{value:"paid",children:"Paid"}),e.jsx(i,{value:"failed",children:"Failed"}),e.jsx(i,{value:"refunded",children:"Refunded"})]})]}),e.jsxs(D,{value:c,onValueChange:g,children:[e.jsx(P,{className:"w-[150px]",children:e.jsx(T,{placeholder:"Method"})}),e.jsxs(I,{children:[e.jsx(i,{value:"all",children:"All Methods"}),e.jsx(i,{value:"cash",children:"Cash"}),e.jsx(i,{value:"online",children:"Online"})]})]}),e.jsx(U,{type:"date",value:o,onChange:u=>v(u.target.value),className:"w-auto"}),e.jsx(p,{variant:"outline",onClick:m,children:"Clear"})]})]})})}),Ue=({payment:s,isExpanded:a,onToggle:r,onEdit:l,onDelete:c,getStatusBadge:g,getMethodBadge:o,formatPrice:v,formatDate:m,formatDateTime:u})=>e.jsxs(e.Fragment,{children:[e.jsxs(R,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:r,children:[e.jsx(f,{className:"w-12",children:e.jsx(p,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:a?e.jsx(Ee,{className:"h-4 w-4"}):e.jsx(ye,{className:"h-4 w-4"})})}),e.jsx(f,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:e.jsx(E,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.order?.customer?.name||"Unknown"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.order?.customer?.email||"No email"})]})]})}),e.jsx(f,{children:s.order?.customer?.passport_country?e.jsx(M,{variant:"outline",className:"text-xs",children:s.order.customer.passport_country}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"N/A"})}),e.jsx(f,{children:g(s.status)}),e.jsx(f,{children:o(s.method)}),e.jsx(f,{children:e.jsx("div",{className:"font-semibold",children:v(s.amount)})}),e.jsx(f,{children:e.jsx("div",{className:"text-sm",children:m(s.created_at)})}),e.jsx(f,{onClick:h=>h.stopPropagation(),children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>l(s),className:"bg-secondary text-secondary-foreground",children:e.jsx(we,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>c(s),className:"bg-destructive text-destructive-foreground",children:e.jsx(Se,{className:"h-4 w-4"})})]})})]}),a&&e.jsx(R,{children:e.jsx(f,{colSpan:8,className:"p-0",children:e.jsx("div",{className:"bg-muted/20 p-4 border-b",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-20",children:[e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(E,{className:"h-4 w-4"})," ","Payment Details"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"External ID:"}),e.jsx("span",{className:"font-mono",children:s.external_id||"—"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Paid At:"}),e.jsx("span",{children:u(s.paid_at)})]}),s.payment_url&&e.jsxs("div",{className:"flex justify-between items-center mt-3",children:[e.jsx("span",{className:"text-muted-foreground",children:"Invoice:"}),e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>window.open(s.payment_url,"_blank"),className:"text-blue-600 hover:text-blue-700",children:[e.jsx(Me,{className:"h-4 w-4 mr-1"})," ","View Invoice"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"})," Order Details"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Order ID:"}),e.jsx("span",{className:"font-mono",children:s.order?.id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Order Date:"}),e.jsx("span",{children:u(s.order?.created_at)})]})]})]})]})})})})]}),Ve=({payments:s,expandedRows:a,toggleRow:r,onEdit:l,onDelete:c,getStatusBadge:g,getMethodBadge:o,formatPrice:v,formatDate:m,formatDateTime:u,sortBy:h,sortDirection:C,handleSort:b})=>{const N=({field:d,children:y})=>e.jsx(w,{className:"cursor-pointer",onClick:()=>b(d),children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{children:y}),h===d&&e.jsx(Te,{className:`h-3 w-3 ${C==="asc"?"rotate-180":""}`})]})});return e.jsx("div",{className:"rounded-md border",children:e.jsxs(ke,{children:[e.jsx(Fe,{children:e.jsxs(R,{children:[e.jsx(w,{className:"w-12"}),e.jsx(N,{field:"order.customer.name",children:"Customer"}),e.jsx(w,{children:"Country"}),e.jsx(N,{field:"status",children:"Status"}),e.jsx(N,{field:"method",children:"Method"}),e.jsx(N,{field:"amount",children:"Amount"}),e.jsx(N,{field:"created_at",children:"Date"}),e.jsx(w,{children:"Actions"})]})}),e.jsx(Ae,{children:s?.length?s.map(d=>e.jsx(Ue,{payment:d,isExpanded:a.includes(d.id),onToggle:()=>r(d.id),onEdit:l,onDelete:c,getStatusBadge:g,getMethodBadge:o,formatPrice:v,formatDate:m,formatDateTime:u},d.id)):e.jsx(R,{children:e.jsx(f,{colSpan:8,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-muted-foreground",children:[e.jsx(E,{className:"h-12 w-12 mb-2"}),e.jsx("p",{children:"No payments found"})]})})})})]})})},qe=({data:s,setData:a,onSubmit:r,processing:l})=>e.jsxs("form",{onSubmit:r,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(V,{htmlFor:"edit_method",className:"text-right",children:"Method"}),e.jsxs(D,{value:s.method,onValueChange:c=>a("method",c),children:[e.jsx(P,{className:"col-span-3",children:e.jsx(T,{placeholder:"Select method"})}),e.jsxs(I,{children:[e.jsx(i,{value:"cash",children:"Cash"}),e.jsx(i,{value:"online",children:"Online"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(V,{htmlFor:"edit_status",className:"text-right",children:"Status"}),e.jsxs(D,{value:s.status,onValueChange:c=>a("status",c),children:[e.jsx(P,{className:"col-span-3",children:e.jsx(T,{placeholder:"Select status"})}),e.jsxs(I,{children:[e.jsx(i,{value:"pending",children:"Pending"}),e.jsx(i,{value:"paid",children:"Paid"}),e.jsx(i,{value:"failed",children:"Failed"}),e.jsx(i,{value:"refunded",children:"Refunded"})]})]})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx(p,{type:"submit",disabled:l,children:"Save Changes"})})]}),Xe=({paginationData:s,buildPaginationUrl:a})=>{const r=l=>{l&&_.get(a(l),{},{preserveState:!0,replace:!0})};return e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",s?.from," to ",s?.to," of ",s?.total," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{variant:"outline",size:"sm",onClick:()=>r(s.prev_page_url),disabled:!s?.prev_page_url,children:"Previous"}),e.jsx(p,{variant:"outline",size:"sm",onClick:()=>r(s.next_page_url),disabled:!s?.next_page_url,children:"Next"})]})]})},Ge=({isOpen:s,onOpenChange:a,onConfirm:r,payment:l})=>l?e.jsx(q,{open:s,onOpenChange:a,children:e.jsxs(X,{children:[e.jsxs(G,{children:[e.jsx(J,{children:"Confirm Deletion"}),e.jsx(K,{children:"Are you sure you want to delete this payment? This action cannot be undone."})]}),e.jsxs(Ie,{children:[e.jsx(p,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(p,{variant:"destructive",onClick:r,children:"Delete"})]})]})}):null;function Je(){const{payments:s,filters:a,totals:r,flash:l}=Ne().props,[c,g]=x.useState(a?.search||""),[o,v]=x.useState(a?.status||"all"),[m,u]=x.useState(a?.method||"all"),[h,C]=x.useState(a?.date_from||""),[b,N]=x.useState(a?.sort_by||"created_at"),[d,y]=x.useState(a?.sort_direction||"desc"),[Y,Z]=x.useState([]),[ee,k]=x.useState(!1),[se,F]=x.useState(!1),[A,z]=x.useState(null),{data:te,setData:B,put:ae,processing:re,reset:le}=be({method:"",notes:"",status:"pending"});x.useEffect(()=>{l?.success&&H.success(l.success),l?.error&&H.error(l.error)},[l]),x.useEffect(()=>{const t=setTimeout(()=>ne(1),500);return()=>clearTimeout(t)},[c,o,m,h,b,d]);const ne=(t=1)=>{_.get(route("payments.index"),{search:c,status:o==="all"?"":o,method:m==="all"?"":m,date_from:h||"",date_to:h||"",sort_by:b,sort_direction:d,page:t},{preserveState:!0,replace:!0})},ce=t=>{b===t?y(d==="asc"?"desc":"asc"):(N(t),y("asc"))},ie=()=>{g(""),v("all"),u("all"),C(""),N("created_at"),y("desc")},de=t=>{if(!t)return null;const n=new URL(t),j=new URLSearchParams(n.search);return j.set("search",c),j.set("status",o==="all"?"":o),j.set("method",m==="all"?"":m),j.set("date_from",h||""),j.set("date_to",h||""),j.set("sort_by",b),j.set("sort_direction",d),`${n.pathname}?${j.toString()}`},oe=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(t||0),me=t=>t?new Date(t).toLocaleDateString():"—",xe=t=>t?new Date(t).toLocaleString():"—",ue=t=>{let n="secondary";return t==="pending"?n="warning":t==="paid"?n="success":t==="failed"?n="destructive":t==="refunded"&&(n="purple"),e.jsx(M,{variant:n,className:"capitalize px-3 py-1 text-xs font-medium w-20 justify-center",children:t})},he=t=>{let n="outline";return t==="cash"?n="purple":t==="online"&&(n="info"),e.jsx(M,{variant:n,className:"capitalize px-3 py-1 text-xs font-medium w-20 justify-center",children:t||"—"})},je=t=>Z(n=>n.includes(t)?n.filter(j=>j!==t):[...n,t]),fe=t=>{z(t),B({method:t.method,notes:t.notes||"",status:t.status}),k(!0)},pe=t=>{z(t),F(!0)},ge=t=>{t.preventDefault(),ae(route("payments.update",A.id),{onSuccess:()=>{k(!1),le()}})},ve=()=>{_.delete(route("payments.destroy",A.id),{preserveState:!0,onSuccess:()=>{F(!1)}})};return e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx(He,{totals:r}),e.jsx(L,{children:e.jsxs(O,{className:"pt-0",children:[e.jsx($e,{search:c,setSearch:g,status:o,setStatus:v,method:m,setMethod:u,dateRange:h,setDateRange:C,clearFilters:ie}),e.jsx(Ve,{payments:s.data,expandedRows:Y,toggleRow:je,onEdit:fe,onDelete:pe,getStatusBadge:ue,getMethodBadge:he,formatPrice:oe,formatDate:me,formatDateTime:xe,sortBy:b,sortDirection:d,handleSort:ce}),e.jsx(Xe,{paginationData:s,buildPaginationUrl:de,router:_})]})}),e.jsx(q,{open:ee,onOpenChange:k,children:e.jsxs(X,{className:"sm:max-w-[425px]",children:[e.jsxs(G,{children:[e.jsx(J,{children:"Edit Payment"}),e.jsx(K,{children:"Update payment details and change status if needed."})]}),e.jsx(qe,{data:te,setData:B,onSubmit:ge,processing:re})]})}),e.jsx(Ge,{isOpen:se,onOpenChange:F,onConfirm:ve,payment:A})]})}Je.layout=s=>e.jsx(Ce,{children:s});export{Je as default};
