import{j as e,r as h,b as H,c as He,u as se}from"./app-D9VRIkeW.js";import{c as he,B as j}from"./button-CEil9SyP.js";import{a as ze,b as Ve,c as qe,C as Ge,d as We}from"./card-VJI4IhOW.js";import{S as Xe,a as te,b as ae,c as re,d as le,e as ne,D as L,f as Je,g as B,h as P,i as O,A as Ke,j as z,k as V}from"./select-D7qJEMU0.js";import{P as Qe,T as Ye,t as ie}from"./index-C1Tk4ak8.js";import{X as Ze,d as es,U as ss,A as ts}from"./AuthenticatedLayout-YMI5X6zW.js";import{P as as}from"./plus-93vJ37x5.js";import{I as R,L as q}from"./label-CLzS-Qwo.js";import{F as ce}from"./funnel-CNNfTh-5.js";import{C as G}from"./calendar-DnQqzx8U.js";import{T as f,a as d,b as W,c as X,d as v,e as J}from"./table-CmSlE4gq.js";import{B as M}from"./badge-BPShEb55.js";import{S as oe}from"./scroll-area-Din-pKP0.js";import{C as rs}from"./chevron-down-DIy7m1ZU.js";/* empty css            */import"./index-BPx5MBbd.js";import"./index-D7CwUK-e.js";import"./index-B1E0rpQf.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],ns=he("crown",ls);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["path",{d:"M16 10h2",key:"8sgtl7"}],["path",{d:"M16 14h2",key:"epxaof"}],["path",{d:"M6.17 15a3 3 0 0 1 5.66 0",key:"n6f512"}],["circle",{cx:"9",cy:"11",r:"2",key:"yxgjnd"}],["rect",{x:"2",y:"5",width:"20",height:"14",rx:"2",key:"qneu4z"}]],cs=he("id-card",is),os=({onAddCustomer:s})=>e.jsx(ze,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(Ve,{className:"text-2xl font-bold",children:"Customers"}),e.jsx(qe,{children:"Manage your customer database"})]}),e.jsxs(j,{onClick:s,className:"flex items-center gap-2",children:[e.jsx(as,{className:"h-4 w-4"})," Add Customer"]})]})}),ds=({searchTerm:s,setSearchTerm:r,selectedCountry:l,setSelectedCountry:i,selectedMembership:n,setSelectedMembership:c,lastVisitFrom:m,setLastVisitFrom:p,lastVisitTo:u,setLastVisitTo:t,clearFilters:o,countries:C})=>{const A=[{value:"all",label:"All Memberships"},{value:"regular",label:"Regular"},{value:"silver",label:"Silver"},{value:"gold",label:"Gold"},{value:"platinum",label:"Platinum"}],[_,D]=h.useState(!1),[y,k]=h.useState(m),[E,w]=h.useState(u),I=()=>{p(y),t(E),D(!1)},S=()=>{k(""),w(""),p(""),t(""),D(!1)},F=()=>!m&&!u?"Select Last Visit Range":m&&!u?m:m&&u?`${m} - ${u}`:"Select Last Visit Range";return e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(R,{placeholder:"Search customers...",value:s,onChange:x=>r(x.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(te,{value:l,onValueChange:i,children:[e.jsxs(ae,{className:"w-full md:w-[180px]",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),e.jsx(re,{placeholder:"Country"})]}),e.jsx(le,{children:C.map(x=>e.jsx(ne,{value:x,children:x==="all"?"All Countries":x},x))})]}),e.jsxs(te,{value:n,onValueChange:c,children:[e.jsxs(ae,{className:"w-full md:w-[180px]",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"}),e.jsx(re,{placeholder:"Membership"})]}),e.jsx(le,{children:A.map(x=>e.jsx(ne,{value:x.value,children:x.label},x.value))})]}),e.jsxs(L,{open:_,onOpenChange:D,children:[e.jsx(Je,{asChild:!0,children:e.jsxs(j,{variant:"outline",className:"w-full md:w-52 justify-center text-left font-normal",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),F()]})}),e.jsxs(B,{className:"sm:max-w-96",children:[e.jsx(P,{children:e.jsx(O,{children:"Select Last Visit Range"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"from-date",children:"From Date"}),e.jsx(R,{id:"from-date",type:"date",value:y,onChange:x=>k(x.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"to-date",children:"To Date"}),e.jsx(R,{id:"to-date",type:"date",value:E,onChange:x=>w(x.target.value)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(j,{variant:"outline",onClick:S,children:"Clear"}),e.jsx(j,{onClick:I,children:"Apply"})]})]})]})]}),e.jsxs(j,{variant:"outline",onClick:o,className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4"})," Clear"]})]})]})},U=({title:s,icon:r,headerBg:l,headerText:i,children:n})=>e.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:`p-2 rounded-full ${l}`,children:e.jsx(r,{className:`h-5 w-5 ${i}`})}),e.jsx("h3",{className:"text-lg font-semibold",children:s})]}),e.jsx("div",{className:"space-y-2",children:n})]}),N=({label:s,value:r,children:l})=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-muted-foreground",children:[s,":"]}),e.jsx("span",{className:"font-medium text-right",children:r??l??"—"})]}),hs=({customer:s,isExpanded:r,onToggle:l,onEdit:i,onDelete:n,formatDate:c})=>{const m=t=>{switch(t){case"platinum":return"default";case"gold":return"warning";case"silver":return"outline";default:return"destructive"}},p=t=>String(t||"").split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1).toLowerCase()).join(" "),u=t=>Array.isArray(t?.service_names)&&t.service_names.length?t.service_names.join(", "):Array.isArray(t?.items)&&t.items.length?t.items.map(o=>o.name).join(", "):"—";return e.jsxs(e.Fragment,{children:[e.jsxs(f,{className:"cursor-pointer hover:bg-muted/50",onClick:l,children:[e.jsx(d,{children:e.jsx(j,{variant:"ghost",size:"sm",children:r?e.jsx(rs,{className:"h-4 w-4"}):e.jsx(es,{className:"h-4 w-4"})})}),e.jsx(d,{className:"font-medium",children:s.name}),e.jsx(d,{children:s.email||"N/A"}),e.jsx(d,{children:s.phone||"N/A"}),e.jsx(d,{children:s.passport_country&&e.jsx(M,{variant:"outline",children:s.passport_country})}),e.jsx(d,{children:s.birth_date?c(s.birth_date):"N/A"}),e.jsx(d,{children:e.jsxs(M,{variant:"outline",children:[s.total_visits," ",s.total_visits>1?"Visits":"Visit"]})}),e.jsx(d,{children:s.membership?e.jsxs(M,{variant:m(s.membership.membership_type),children:[p(s.membership.membership_type),s.membership.discount_percentage>0&&` (${s.membership.discount_percentage}%)`]}):e.jsx("span",{className:"text-muted-foreground",children:"None"})}),e.jsx(d,{onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(j,{variant:"ghost",size:"sm",onClick:i,className:"bg-secondary text-secondary-foreground",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"sm",onClick:n,className:"bg-destructive text-destructive-foreground",children:e.jsx(Ye,{className:"h-4 w-4"})})]})})]}),r&&e.jsx(f,{children:e.jsx(d,{colSpan:9,className:"p-0",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs(U,{title:"Customer",icon:ss,headerBg:"bg-blue-100",headerText:"text-blue-600",children:[e.jsx(N,{label:"Name",value:s?.name}),e.jsx(N,{label:"Email",value:s?.email}),e.jsx(N,{label:"Phone",value:s?.phone}),e.jsx(N,{label:"Country",value:s?.passport_country})]}),e.jsxs(U,{title:"Identity",icon:cs,headerBg:"bg-amber-100",headerText:"text-amber-600",children:[e.jsx(N,{label:"Birth Date",value:s.birth_date?c(s.birth_date):"N/A"}),e.jsx(N,{label:"Total Visits",value:s.total_visits})]}),e.jsxs(U,{title:"Membership",icon:ns,headerBg:"bg-purple-100",headerText:"text-purple-600",children:[e.jsx(N,{label:"Type",children:s.membership?e.jsx(M,{variant:m(s.membership.membership_type),children:p(s.membership.membership_type)}):"—"}),e.jsx(N,{label:"Discount",value:s.membership?.discount_percentage>0?`${s.membership.discount_percentage}%`:"0%"}),e.jsx(N,{label:"Created",value:s.created_at?new Date(s.created_at).toLocaleDateString():"N/A"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mt-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(G,{className:"h-4 w-4 text-indigo-600"}),e.jsx("h4",{className:"font-semibold text-sm",children:"Booking History"})]}),e.jsx("div",{className:"border rounded-lg bg-background overflow-hidden",children:e.jsx(oe,{className:"h-64",children:e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(f,{children:[e.jsx(v,{children:"Check-in"}),e.jsx(v,{children:"Room"}),e.jsx(v,{children:"Status"})]})}),e.jsx(J,{children:s.bookings&&s.bookings.length>0?s.bookings.map(t=>e.jsxs(f,{children:[e.jsx(d,{children:t.checkin_at?c(t.checkin_at):"N/A"}),e.jsx(d,{children:t.room_number||"N/A"}),e.jsx(d,{children:p(t.status)})]},t.id)):e.jsx(f,{children:e.jsx(d,{colSpan:3,className:"h-24 text-center text-muted-foreground",children:"No booking history found."})})})]})})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(G,{className:"h-4 w-4 text-indigo-600"}),e.jsx("h4",{className:"font-semibold text-sm",children:"Order History"})]}),e.jsx("div",{className:"border rounded-lg bg-background overflow-hidden",children:e.jsx(oe,{className:"h-64",children:e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(f,{children:[e.jsx(v,{children:"Date"}),e.jsx(v,{children:"Services"}),e.jsx(v,{children:"Status"})]})}),e.jsx(J,{children:s.orders&&s.orders.length>0?s.orders.map(t=>e.jsxs(f,{children:[e.jsx(d,{children:t.created_at?new Date(t.created_at).toLocaleDateString():"N/A"}),e.jsx(d,{className:"max-w-[280px]",children:e.jsx("div",{className:"truncate",children:u(t)})}),e.jsx(d,{children:p(t.status)})]},t.id)):e.jsx(f,{children:e.jsx(d,{colSpan:3,className:"h-24 text-center text-muted-foreground",children:"No order history found."})})})]})})})]})]})]})})},`${s.id}-details`)]})},xs=({customers:s,expandedRows:r,toggleRow:l,openEditModal:i,openDeleteModal:n,formatDate:c,sortBy:m,sortDirection:p,handleSort:u})=>{const t=({field:o,children:C})=>e.jsx(v,{className:"cursor-pointer",onClick:()=>u(o),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:C}),m===o&&e.jsx(Ke,{className:`h-3 w-3 ${p==="asc"?"rotate-180":""}`})]})});return e.jsx("div",{className:"rounded-md border",children:e.jsxs(W,{children:[e.jsx(X,{children:e.jsxs(f,{children:[e.jsx(v,{className:"w-8"}),e.jsx(t,{field:"name",children:"Name"}),e.jsx(t,{field:"email",children:"Email"}),e.jsx(t,{field:"phone",children:"Phone"}),e.jsx(t,{field:"passport_country",children:"Country"}),e.jsx(t,{field:"birth_date",children:"Birth Date"})," ",e.jsx(t,{field:"total_visits",children:"Visits"}),e.jsx(v,{children:"Membership"}),e.jsx(v,{children:"Actions"})]})}),e.jsx(J,{children:s.length>0?s.map(o=>e.jsx(hs,{customer:o,isExpanded:r.includes(o.id),onToggle:()=>l(o.id),onEdit:()=>i(o),onDelete:()=>n(o),formatDate:c},o.id)):e.jsx(f,{children:e.jsx(d,{colSpan:10,className:"text-center py-8",children:"No customers found"})})})]})})},de=({data:s,setData:r,errors:l})=>{const i=[{id:"name",label:"Name *",type:"text"},{id:"email",label:"Email",type:"email"},{id:"phone",label:"Phone",type:"text"},{id:"passport_country",label:"Country",type:"text"},{id:"birth_date",label:"Birth Date",type:"date"},{id:"notes",label:"Notes",type:"text"}];return e.jsx("div",{className:"grid gap-4 py-4",children:i.map(n=>e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(q,{htmlFor:n.id,className:"text-right",children:n.label}),e.jsx(R,{id:n.id,type:n.type,value:s[n.id]||"",onChange:c=>r(n.id,c.target.value),className:"col-span-3"}),l[n.id]&&e.jsx("p",{className:"text-red-500 text-sm col-span-4 text-right",children:l[n.id]})]},n.id))})},ms=({isOpen:s,onOpenChange:r,onConfirm:l,customer:i})=>i?e.jsx(L,{open:s,onOpenChange:r,children:e.jsxs(B,{children:[e.jsxs(P,{children:[e.jsx(O,{children:"Confirm Deletion"}),e.jsxs(z,{children:["Are you sure you want to delete ",e.jsx("strong",{children:i.name}),"? This action cannot be undone."]})]}),e.jsxs(V,{children:[e.jsx(j,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(j,{variant:"destructive",onClick:l,children:"Delete"})]})]})}):null,ps=({paginationData:s,buildPaginationUrl:r})=>{const{from:l,to:i,total:n,prev_page_url:c,next_page_url:m,current_page:p}=s,u=t=>{t&&H.get(r(t),{},{preserveState:!0,replace:!0})};return e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",l," to ",i," of ",n," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>u(c),disabled:!c,children:"Previous"}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>u(m),disabled:!m,children:"Next"})]})]})};function us(){const{customers:s,filters:r,flash:l}=He().props,[i,n]=h.useState(r.search||""),[c,m]=h.useState(r.passport_country||"all"),[p,u]=h.useState(r.membership_type||"all"),[t,o]=h.useState(r.last_visit_from||""),[C,A]=h.useState(r.last_visit_to||""),[_,D]=h.useState(r.sort_by||"created_at"),[y,k]=h.useState(r.sort_direction||"desc"),[E,w]=h.useState(!1),[I,S]=h.useState(!1),[F,x]=h.useState(!1),[T,$]=h.useState(null),[xe,me]=h.useState(["all"]),[pe,ue]=h.useState([]),K={name:"",email:"",phone:"",passport_country:"",birth_date:"",notes:""},{data:je,setData:ge,post:be,processing:fe,errors:ve,reset:Q,clearErrors:Ne,setDefaults:Ce}=se(K),Y={name:"",email:"",phone:"",passport_country:"",birth_date:"",notes:""},{data:ye,setData:Z,put:_e,processing:De,errors:we,reset:ee,clearErrors:Se,setDefaults:ke}=se(Y);h.useEffect(()=>{const a=[...new Set(s.data.map(g=>g.passport_country).filter(Boolean))];me(["all",...a])},[s]),h.useEffect(()=>{l?.success&&ie.success(l.success),l?.error&&ie.error(l.error)},[l]),h.useEffect(()=>{const a=setTimeout(()=>Te(1),500);return()=>clearTimeout(a)},[i,c,p,t,C,_,y]);const Te=(a=r.page||1)=>{H.get(route("customers.index"),{search:i,passport_country:c==="all"?"":c,membership_type:p==="all"?"":p,last_visit_from:t,last_visit_to:C,sort_by:_,sort_direction:y,page:a},{preserveState:!0,replace:!0})},Ae=a=>{D(a),k(g=>g==="asc"?"desc":"asc")},Ee=()=>{Ce(K),Q(),Ne(),S(!1),$(null),w(!0)},Me=a=>{Re(a),Se(),$(a),S(!0)},Re=a=>{ke(Y),ee(),Z(g=>({...g,name:a.name??"",email:a.email??"",phone:a.phone??"",passport_country:a.passport_country??"",birth_date:a.birth_date??"",notes:a.notes??""}))},Le=a=>{$(a),x(!0)},Be=a=>{a.preventDefault(),be(route("customers.store"),{onSuccess:()=>{w(!1),Q()}})},Pe=a=>{a.preventDefault(),T&&_e(route("customers.update",T.id),{onSuccess:()=>{S(!1),ee()}})},Oe=()=>{T&&H.delete(route("customers.destroy",T.id),{onSuccess:()=>x(!1)})},Ie=()=>{n(""),m("all"),u("all"),o(""),A(""),D("created_at"),k("desc")},Fe=a=>a?new Date(a).toLocaleDateString():"N/A",$e=a=>ue(g=>g.includes(a)?g.filter(b=>b!==a):[...g,a]),Ue=a=>{if(!a)return null;const g=new URL(a),b=new URLSearchParams(g.search);return b.set("search",i),b.set("passport_country",c==="all"?"":c),b.set("membership_type",p==="all"?"":p),b.set("last_visit_from",t),b.set("last_visit_to",C),b.set("sort_by",_),b.set("sort_direction",y),`${g.pathname}?${b.toString()}`};return e.jsxs("div",{className:"container mx-auto py-2 px-4",children:[e.jsxs(Ge,{className:"mb-8",children:[e.jsx(os,{onAddCustomer:Ee}),e.jsxs(We,{children:[e.jsx(ds,{searchTerm:i,setSearchTerm:n,selectedCountry:c,setSelectedCountry:m,selectedMembership:p,setSelectedMembership:u,lastVisitFrom:t,setLastVisitFrom:o,lastVisitTo:C,setLastVisitTo:A,clearFilters:Ie,countries:xe}),e.jsx(xs,{customers:s.data,expandedRows:pe,toggleRow:$e,openEditModal:Me,openDeleteModal:Le,formatDate:Fe,sortBy:_,sortDirection:y,handleSort:Ae}),e.jsx(ps,{paginationData:s,buildPaginationUrl:Ue})]})]}),e.jsx(L,{open:E,onOpenChange:w,children:e.jsxs(B,{className:"sm:max-w-[425px]",children:[e.jsxs(P,{children:[e.jsx(O,{children:"Create New Customer"}),e.jsx(z,{children:"Add a new customer to your database"})]}),e.jsxs("form",{onSubmit:Be,children:[e.jsx(de,{data:je,setData:ge,errors:ve}),e.jsx(V,{children:e.jsx(j,{type:"submit",disabled:fe,children:"Create Customer"})})]})]})}),e.jsx(L,{open:I,onOpenChange:S,children:e.jsxs(B,{className:"sm:max-w-[425px]",children:[e.jsxs(P,{children:[e.jsx(O,{children:"Edit Customer"}),e.jsx(z,{children:"Update customer information"})]}),e.jsxs("form",{onSubmit:Pe,children:[e.jsx(de,{data:ye,setData:Z,errors:we}),e.jsx(V,{children:e.jsx(j,{type:"submit",disabled:De,children:"Update Customer"})})]})]})}),e.jsx(ms,{isOpen:F,onOpenChange:x,onConfirm:Oe,customer:T})]})}us.layout=s=>e.jsx(ts,{children:s});export{us as default};
