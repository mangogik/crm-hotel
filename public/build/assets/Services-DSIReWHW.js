import{j as e,r as d,b as ie,c as Fs,u as As}from"./app-D9VRIkeW.js";import{c as hs,B as I}from"./button-CEil9SyP.js";import{a as ke,b as Se,c as Ce,C as je,d as Ne}from"./card-VJI4IhOW.js";import{S as qs,a as re,b as le,c as oe,d as ce,e as F,A as Ts,D as be,g as ve,h as ye,i as we,j as _e,k as Ee}from"./select-D7qJEMU0.js";import{P as Ms,T as Es,t as rs}from"./index-C1Tk4ak8.js";import{X as pe,d as Ds,A as $s}from"./AuthenticatedLayout-YMI5X6zW.js";import{B as ee}from"./badge-BPShEb55.js";import{P as De}from"./plus-93vJ37x5.js";import{I as K,L as Gs}from"./label-CLzS-Qwo.js";import{F as Te}from"./funnel-CNNfTh-5.js";import{T as H,a as C,b as Re,c as ze,d as B,e as Be}from"./table-CmSlE4gq.js";import{S as ls}from"./scroll-area-Din-pKP0.js";import{C as Rs}from"./chevron-down-DIy7m1ZU.js";import{C as zs}from"./circle-check-big-BSBG7wMR.js";import{I as os}from"./info-DmtQGUyf.js";import{C as ps,T as Bs}from"./textarea-Cjo84kNv.js";import{I as us,S as Ls}from"./separator-DQyANi-u.js";import{L as $e}from"./loader-circle-DJRFNSJS.js";import{A as Us}from"./arrow-right-DXmiJtum.js";import{S as Hs}from"./star--dTAw3i1.js";import{T as Qs}from"./trending-up-DBEC6c0V.js";/* empty css            */import"./index-BPx5MBbd.js";import"./index-D7CwUK-e.js";import"./index-B1E0rpQf.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"m22 11-1.296-1.296a2.4 2.4 0 0 0-3.408 0L11 16",key:"9kzy35"}],["path",{d:"M4 8a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2",key:"1t0f0t"}],["circle",{cx:"13",cy:"7",r:"1",fill:"currentColor",key:"1obus6"}],["rect",{x:"8",y:"2",width:"14",height:"14",rx:"2",key:"1gvhby"}]],Ws=hs("images",Vs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Js=hs("list",Xs),Ys=({onAddService:n})=>e.jsx(ke,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(Se,{className:"text-2xl font-bold",children:"Services"}),e.jsx(Ce,{children:"Manage your service offerings"})]}),e.jsxs(I,{onClick:n,className:"flex items-center gap-2",children:[e.jsx(De,{className:"h-4 w-4"})," Add Service"]})]})}),Zs=({searchTerm:n,setSearchTerm:t,selectedType:i,setSelectedType:o,selectedFulfillment:_,setSelectedFulfillment:j,selectedOfferingSession:f,setSelectedOfferingSession:u,clearFilters:x,filterOptions:N})=>{const k=N?.types??["fixed","per_unit","selectable","multiple_options","free"],v=N?.fulfillment_types??["direct","staff_assisted"],S=N?.offering_sessions??["pre_checkin","post_checkin","pre_checkout"],h=c=>c==="per_unit"?"Per Unit":c==="selectable"?"Selectable":c==="multiple_options"?"Multiple Options":c==="free"?"Free":"Fixed Price",y=c=>c==="staff_assisted"?"Staff Assisted":"Direct",b=c=>c==="pre_checkin"?"Pre Check-in":c==="post_checkin"?"Post Check-in":"Pre Checkout";return e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(qs,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(K,{placeholder:"Search services...",value:n,onChange:c=>t(c.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(re,{value:i,onValueChange:o,children:[e.jsxs(le,{className:"w-[180px]",children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),e.jsx(oe,{placeholder:"Type"})]}),e.jsxs(ce,{children:[e.jsx(F,{value:"all",children:"All Types"}),k.map(c=>e.jsx(F,{value:c,children:h(c)},c))]})]}),e.jsxs(re,{value:_,onValueChange:j,children:[e.jsxs(le,{className:"w-[180px]",children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),e.jsx(oe,{placeholder:"Fulfillment"})]}),e.jsxs(ce,{children:[e.jsx(F,{value:"all",children:"All Fulfillments"}),v.map(c=>e.jsx(F,{value:c,children:y(c)},c))]})]}),e.jsxs(re,{value:f,onValueChange:u,children:[e.jsxs(le,{className:"w-[180px]",children:[e.jsx(Te,{className:"mr-2 h-4 w-4"}),e.jsx(oe,{placeholder:"Session"})]}),e.jsxs(ce,{children:[e.jsx(F,{value:"all",children:"All Sessions"}),S.map(c=>e.jsx(F,{value:c,children:b(c)},c))]})]}),e.jsxs(I,{variant:"outline",onClick:x,className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"})," Clear Sort & Filters"]})]})]})},Ks=({service:n,isExpanded:t,onToggle:i,onEdit:o,onDelete:_,onOpenImages:j,formatPrice:f,getTypeBadge:u,getFulfillmentBadge:x,getOfferingSessionBadge:N})=>{const k=n.type==="multiple_options",v=()=>n.type==="selectable"||k?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-sm",children:"Multiple options"}),e.jsx(os,{className:"h-3 w-3 text-muted-foreground"})]}):!n.price||Number(n.price)===0?e.jsx("span",{className:"inline-flex text-xs font-medium px-2 py-1 rounded border border-emerald-200 bg-emerald-50 text-emerald-700",children:"Free"}):e.jsx("span",{className:"font-medium",children:f(n.price)}),S=n.has_active_questions&&n.active_question?.questions_json?.length>0,h=(n.type==="selectable"||k)&&Array.isArray(n.options)&&n.options.length>0,y=({options:O})=>e.jsx("div",{className:"flex flex-wrap gap-2",children:O.map((T,$)=>e.jsxs(ee,{variant:"outline",className:"text-xs px-2 py-1 flex flex-col items-start",children:[e.jsx("span",{className:"mr-1 font-medium",children:T.name}),e.jsx("span",{className:"text-muted-foreground",children:f(T.price)})]},$))}),b=({options:O})=>e.jsx("div",{className:"rounded-md border bg-background",children:e.jsx(ls,{className:"max-h-56",children:e.jsxs(Re,{children:[e.jsx(ze,{children:e.jsxs(H,{children:[e.jsx(B,{className:"py-2",children:"Option"}),e.jsx(B,{className:"py-2 text-right",children:"Price"})]})}),e.jsx(Be,{children:O.map((T,$)=>e.jsxs(H,{children:[e.jsx(C,{className:"text-sm py-2",children:T.name}),e.jsx(C,{className:"text-right font-medium py-2",children:f(T.price)})]},$))})]})})}),c=({questions:O})=>e.jsx("ol",{className:"list-decimal ml-4 space-y-1",children:O.map((T,$)=>e.jsx("li",{className:"text-sm",children:T},$))}),A=({questions:O})=>e.jsx("div",{className:"rounded-md border bg-background",children:e.jsx(ls,{className:"max-h-56 p-3",children:e.jsx("ol",{className:"list-decimal ml-4 space-y-1",children:O.map((T,$)=>e.jsx("li",{className:"text-sm",children:T},$))})})}),E=h&&n.options.length<=4,ue=h&&n.options.length>4,G=n.active_question?.questions_json??[],de=S&&G.length<=5,se=S&&G.length>5,ne=!h&&!S;return e.jsxs(e.Fragment,{children:[e.jsxs(H,{className:"cursor-pointer hover:bg-muted/50",onClick:i,children:[e.jsx(C,{children:e.jsx(I,{variant:"ghost",size:"sm",children:t?e.jsx(Rs,{className:"h-4 w-4"}):e.jsx(Ds,{className:"h-4 w-4"})})}),e.jsx(C,{className:"font-medium",children:n.name}),e.jsx(C,{children:u(n.type,n.unit_name)}),e.jsx(C,{children:x(n.fulfillment_type)}),e.jsx(C,{children:N(n.offering_session)}),e.jsx(C,{children:v()}),e.jsx(C,{children:S?e.jsxs(ee,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200 flex items-center gap-1",children:[e.jsx(zs,{className:"h-3 w-3"}),"Questions"]}):e.jsx("span",{className:"text-muted-foreground text-sm",children:"None"})}),e.jsx(C,{onClick:O=>O.stopPropagation(),children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{variant:"ghost",size:"sm",onClick:o,className:"bg-secondary text-secondary-foreground",children:e.jsx(Ms,{className:"h-4 w-4"})}),e.jsx(I,{variant:"ghost",size:"sm",onClick:_,className:"bg-destructive text-destructive-foreground",children:e.jsx(Es,{className:"h-4 w-4"})})]})})]}),t&&e.jsx(H,{children:e.jsx(C,{colSpan:8,className:"p-0",children:e.jsxs("div",{className:"p-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"text-xs text-muted-foreground leading-tight",children:[e.jsx("div",{className:"font-medium text-sm text-foreground",children:n.name}),e.jsxs("div",{className:"mt-0.5",children:["ID #",n.id]})]}),e.jsxs(I,{type:"button",variant:"outline",size:"sm",className:"flex items-center gap-1 text-xs",onClick:O=>{O.stopPropagation(),j(n)},children:[e.jsx(Ws,{className:"h-4 w-4"}),"View Images"]})]}),e.jsxs("div",{className:"grid gap-3 md:grid-cols-3",children:[e.jsxs("div",{className:"bg-white rounded-md border shadow-sm p-3 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"bg-indigo-100 p-1.5 rounded-full",children:e.jsx(os,{className:"h-4 w-4 text-indigo-600"})}),e.jsx("h3",{className:"text-sm font-semibold",children:"Service Info"})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:n.description?e.jsx("span",{className:"whitespace-pre-wrap break-words",children:n.description}):e.jsx("span",{children:"No description."})})]}),h&&e.jsxs("div",{className:"bg-white rounded-md border shadow-sm p-3 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"bg-green-100 p-1.5 rounded-full",children:e.jsx(Js,{className:"h-4 w-4 text-green-600"})}),e.jsx("h3",{className:"text-sm font-semibold",children:k?"Available Options (Multi-Select)":"Available Options"}),k&&e.jsx(ee,{variant:"outline",className:"ml-auto bg-fuchsia-50 text-fuchsia-700 border-fuchsia-200",children:"Multi-Select"})]}),E&&e.jsx(y,{options:n.options}),ue&&e.jsx(b,{options:n.options})]}),S&&e.jsxs("div",{className:"bg-white rounded-md border shadow-sm p-3 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"bg-purple-100 p-1.5 rounded-full",children:e.jsx(ps,{className:"h-4 w-4 text-purple-600"})}),e.jsx("h3",{className:"text-sm font-semibold",children:"Custom Questions"})]}),de&&e.jsx(c,{questions:G}),se&&e.jsx(A,{questions:G})]})]}),ne&&e.jsx("div",{className:"mt-2 text-xs text-muted-foreground"})]})})},`${n.id}-details`)]})},et=({services:n,expandedRows:t,toggleRow:i,openEditModal:o,openDeleteModal:_,openImagesModal:j,formatPrice:f,formatType:u,formatFulfillment:x,sortBy:N,sortDirection:k,handleSort:v,getTypeBadge:S,getFulfillmentBadge:h,getOfferingSessionBadge:y})=>{const b=({field:c,children:A})=>e.jsx(B,{className:"cursor-pointer",onClick:()=>v(c),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:A}),N===c&&e.jsx(Ts,{className:`h-3 w-3 ${k==="asc"?"rotate-180":""}`})]})});return e.jsx("div",{className:"rounded-md border overflow-x-auto",children:e.jsxs(Re,{className:"min-w-[900px]",children:[e.jsx(ze,{children:e.jsxs(H,{children:[e.jsx(B,{className:"w-8"}),e.jsx(b,{field:"name",children:"Name"}),e.jsx(b,{field:"type",children:"Type"}),e.jsx(b,{field:"fulfillment_type",children:"Fulfillment"}),e.jsx(b,{field:"offering_session",children:"Session"}),e.jsx(b,{field:"price",children:"Price"}),e.jsx(B,{children:"Questions"}),e.jsx(B,{children:"Actions"})]})}),e.jsx(Be,{children:n.length>0?n.map(c=>e.jsx(Ks,{service:c,isExpanded:t.includes(c.id),onToggle:()=>i(c.id),onEdit:A=>{A?.stopPropagation?.(),o(c)},onDelete:A=>{A?.stopPropagation?.(),_(c)},onOpenImages:A=>{j(A)},formatPrice:f,formatType:u,formatFulfillment:x,getTypeBadge:S,getFulfillmentBadge:h,getOfferingSessionBadge:y},c.id)):e.jsx(H,{children:e.jsx(C,{colSpan:8,className:"text-center py-8 text-muted-foreground text-sm",children:"No services found"})})})]})})},cs=2*1024*1024,ds=["image/jpeg","image/jpg","image/png","image/webp"],Me=({title:n,subtitle:t,children:i,className:o="",bodyClassName:_=""})=>e.jsxs("div",{className:`rounded-lg border bg-white shadow-sm flex flex-col ${o}`,children:[e.jsxs("div",{className:"px-4 py-3 border-b sticky top-0 z-10 bg-white",children:[e.jsx("h3",{className:"text-sm font-semibold",children:n}),t&&e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:t})]}),e.jsx("div",{className:`p-4 overflow-y-auto ${_}`,children:i})]}),U=({label:n,htmlFor:t,error:i,children:o})=>e.jsxs("div",{className:"grid grid-cols-4 items-start gap-3",children:[e.jsx(Gs,{htmlFor:t,className:"text-right text-sm pt-2",children:n}),e.jsxs("div",{className:"col-span-3",children:[o,i&&e.jsx("p",{className:"text-red-500 text-xs text-right mt-1",children:i})]})]}),ms=({children:n})=>e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:n}),Ge=({size:n="w-14 h-14"})=>e.jsx("div",{className:`${n} rounded-md border bg-muted/40 animate-pulse flex items-center justify-center text-[10px] text-muted-foreground`,children:e.jsx($e,{className:"w-4 h-4 animate-spin opacity-60"})});function st({mode:n,loadingImagesForEdit:t,currentExisting:i,newPreviewUrl:o,optionName:_,onTriggerPickFile:j,localError:f}){return e.jsxs("div",{className:"bg-muted/5 rounded-md border px-2 py-2 flex flex-col gap-2",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex flex-col items-center text-center min-w-[3.5rem]",children:[e.jsx("div",{className:"text-[10px] text-muted-foreground mb-1 leading-none",children:"Current"}),n==="edit"&&t&&e.jsx(Ge,{}),n==="edit"&&!t&&i&&e.jsx("div",{className:"w-14 h-14 border rounded-md bg-white shadow-sm overflow-hidden",children:e.jsx("img",{src:i.url,alt:i.option_name||"option image",className:"object-cover w-full h-full"})}),n==="create"&&e.jsx("div",{className:"w-14 h-14 border rounded-md bg-muted/20 flex items-center justify-center text-[10px] text-muted-foreground",children:"—"}),n==="edit"&&!t&&!i&&e.jsx("div",{className:"w-14 h-14 border rounded-md bg-muted/20 flex items-center justify-center text-[10px] text-muted-foreground",children:"—"})]}),e.jsx(Us,{className:"w-4 h-4 text-muted-foreground shrink-0"}),e.jsxs("div",{className:"flex flex-col items-center text-center min-w-[3.5rem]",children:[e.jsx("div",{className:"text-[10px] text-muted-foreground mb-1 leading-none",children:"New"}),o?e.jsxs("div",{className:"relative w-14 h-14 border rounded-md bg-white ring-2 ring-purple-500/40 shadow-sm overflow-hidden",children:[e.jsx("img",{src:o,alt:"new option preview",className:"object-cover w-full h-full"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-purple-600 text-white text-[9px] leading-tight px-1 py-[2px] text-center",children:"new"})]}):e.jsx("div",{className:"w-14 h-14 border rounded-md bg-muted/20 flex items-center justify-center text-[10px] text-muted-foreground",children:"—"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 min-w-[7rem] mt-4",children:[e.jsxs(I,{type:"button",variant:"outline",size:"xs",className:"h-7 text-[11px] flex items-center gap-1 p-2",onClick:j,children:[e.jsx(us,{className:"w-3.5 h-3.5"}),"Change Photo"]}),e.jsx("span",{className:"text-[10px] text-muted-foreground leading-tight max-w-[10rem]",children:"JPG / PNG / WebP • max 2MB."})]})]}),e.jsx("div",{className:"pl-[2px]",children:f?e.jsx("p",{className:"text-[10px] text-red-600 leading-relaxed",children:f}):e.jsx("p",{className:"text-[10px] text-muted-foreground leading-relaxed",children:"Guest will see this thumbnail when choosing the option. Only one photo per option."})})]})}function tt({mode:n,index:t,option:i,totalOptions:o,updateOption:_,removeOption:j,loadingImagesForEdit:f,existingOptionImagesByKey:u,newOptionImagePreviews:x,handleReplaceOptionImageSafe:N,optionImageErrors:k}){const v=i.key||`opt_${t+1}`,h=(u[v]||[])[0]||null,y=x[v]||null,b=d.useRef(null),c=()=>{b.current?.click()},A=E=>{N(v,E.target.files)};return e.jsxs("div",{className:"rounded-md border p-3 space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsx(K,{placeholder:"Option name",value:i.name,onChange:E=>_(t,"name",E.target.value),className:"col-span-6"}),e.jsx(K,{type:"number",placeholder:"Price",min:"0",step:"0.01",value:i.price,onChange:E=>_(t,"price",E.target.value),className:"col-span-4"}),e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>j(t),disabled:o<=1,className:"col-span-2",children:e.jsx(pe,{className:"h-4 w-4"})})]}),e.jsx(st,{mode:n,loadingImagesForEdit:f,currentExisting:h,newPreviewUrl:y,optionName:i.name,onTriggerPickFile:c,localError:k[v]||""}),e.jsx("input",{ref:b,type:"file",accept:"image/*",className:"hidden",onChange:A})]})}function nt({mode:n,loadingImagesForEdit:t,existingGeneralImages:i,newGeneralPreviews:o,onDeleteExisting:_,onDeleteNew:j,onAddNewSafe:f,localError:u}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[n==="edit"&&t&&e.jsxs(e.Fragment,{children:[e.jsx(Ge,{}),e.jsx(Ge,{})]}),n==="edit"&&!t&&i.length>0&&i.map(x=>e.jsxs("div",{className:"relative w-16 h-16 border rounded-md bg-white shadow-sm overflow-hidden",children:[e.jsx("img",{src:x.url,alt:x.caption||"service image",className:"object-cover w-full h-full"}),e.jsx("button",{type:"button",className:"absolute top-0 right-0 bg-red-600 text-white rounded-bl-md px-1 py-[2px] text-[10px] flex items-center gap-1",onClick:()=>_(x.id),title:"Remove this image",children:e.jsx(pe,{className:"w-3 h-3"})})]},x.id)),o.length>0&&o.map((x,N)=>e.jsxs("div",{className:"relative w-16 h-16 border rounded-md bg-white ring-2 ring-purple-500/40 shadow-sm overflow-hidden",children:[e.jsx("img",{src:x.url,alt:x.file?.name||"new image",className:"object-cover w-full h-full"}),e.jsx("button",{type:"button",className:"absolute top-0 right-0 bg-purple-600 text-white rounded-bl-md px-1 py-[2px] text-[10px] flex items-center gap-1",onClick:()=>j(N),title:"Remove this new image",children:e.jsx(pe,{className:"w-3 h-3"})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-purple-600 text-white text-[9px] leading-tight px-1 py-[2px] text-center",children:"new"})]},`new-${N}`))]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("label",{className:"inline-flex items-center gap-1 px-2 py-1.5 text-xs border rounded-md bg-white hover:bg-muted cursor-pointer w-fit",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:x=>f(x.target.files)}),e.jsx(us,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Add Images"})]}),u?e.jsx("div",{className:"text-[10px] text-red-600 leading-tight",children:u}):e.jsx("div",{className:"text-[10px] text-muted-foreground leading-tight",children:"JPG / PNG / WebP • max 2MB each. You can remove them here before saving."})]})]})}function xs({mode:n,data:t,setData:i,errors:o,addOption:_,removeOption:j,updateOption:f,initialHasQuestions:u,initialQuestions:x,existingGeneralImages:N,existingOptionImagesByKey:k,markDeleteGeneralImage:v,newGeneralImages:S,newGeneralPreviews:h,setNewGeneralImages:y,setNewGeneralPreviews:b,newOptionImages:c,newOptionImagePreviews:A,setNewOptionImages:E,setNewOptionImagePreviews:ue,handleReplaceOptionImage:G,addNewGeneralImages:de,removeNewGeneralPreview:se,loadingImagesForEdit:ne}){const[O,T]=d.useState(""),[$,te]=d.useState({}),ge=m=>{if(!m||!m.length)return;const p=[];let M="";if(Array.from(m).forEach(w=>{if(w.size>cs){M="One or more images exceed 2MB.";return}if(!ds.includes(w.type)){M="Only JPG, PNG, or WebP images are allowed.";return}p.push(w)}),T(M||""),p.length>0){const w=new DataTransfer;p.forEach(Pe=>w.items.add(Pe)),de(w.files)}},Ie=(m,p)=>{if(!p||!p.length)return;const M=p[0];if(M.size>cs){te(w=>({...w,[m]:"Image too large. Max size is 2MB."}));return}if(!ds.includes(M.type)){te(w=>({...w,[m]:"Unsupported format. Use JPG, PNG, or WebP."}));return}te(w=>({...w,[m]:""})),G(m,p)},[Q,me]=d.useState(t.has_questions||u||!1),[L,ae]=d.useState(t.questions&&t.questions.length?t.questions:x&&x.length?x:[""]);d.useEffect(()=>{me(t.has_questions||u||!1),ae(t.questions&&t.questions.length?t.questions:x&&x.length?x:[""])},[]),d.useEffect(()=>{i("has_questions",Q),i("questions",Q?L:[])},[Q,L,i]);const V=t.type==="selectable",g=t.type==="multiple_options",P=t.type==="per_unit",R=t.type==="fixed",W=t.type==="free";d.useEffect(()=>{W?(t.price!==0&&i("price",0),t.unit_name&&i("unit_name",""),t.options?.length&&i("options",[{name:"",price:""}])):R?((t.price===""||t.price===0)&&i("price",""),i("unit_name","")):P?(t.unit_name||i("unit_name",""),(t.price===""||t.price===0)&&i("price","")):(V||g)&&(t.options?.length||i("options",[{name:"",price:""}]),t.price!==0&&i("price",0),i("unit_name",""))},[t.type]);const xe=d.useMemo(()=>P?"Guest enters quantity; total = qty × price per unit.":R?"Single fixed price for this service.":V?"Guest picks exactly one option; price comes from that option.":g?"Guest may pick multiple options; total is sum of chosen options.":W?"Complimentary service (price = 0).":"",[P,R,V,g,W]),fe=()=>ae(m=>[...m,""]),Oe=m=>ae(p=>p.length<=1?p:p.filter((M,w)=>w!==m)),z=(m,p)=>ae(M=>{const w=[...M];return w[m]=p,w});return e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(Me,{title:"Basics & Configuration",subtitle:xe||"Core details and placement in guest journey.",className:"min-h-[40vh]",bodyClassName:"max-h-[68vh]",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{label:"Name *",htmlFor:"name",error:o.name,children:e.jsx(K,{id:"name",value:t.name,onChange:m=>i("name",m.target.value)})}),e.jsx(U,{label:"Description",htmlFor:"description",error:o.description,children:e.jsx(Bs,{id:"description",value:t.description,onChange:m=>i("description",m.target.value)})}),e.jsx(U,{label:"Images",htmlFor:"images",error:o.images,children:e.jsx(nt,{mode:n,loadingImagesForEdit:ne,existingGeneralImages:N,newGeneralPreviews:h,onDeleteExisting:v,onDeleteNew:se,onAddNewSafe:ge,localError:O})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(U,{label:"Type *",htmlFor:"type",error:o.type,children:e.jsxs(re,{value:t.type,onValueChange:m=>i("type",m),children:[e.jsx(le,{children:e.jsx(oe,{placeholder:"Select type"})}),e.jsxs(ce,{children:[e.jsx(F,{value:"fixed",children:"Fixed Price"}),e.jsx(F,{value:"per_unit",children:"Per Unit"}),e.jsx(F,{value:"selectable",children:"Selectable Options"}),e.jsx(F,{value:"multiple_options",children:"Multiple Options"}),e.jsx(F,{value:"free",children:"Free"})]})]})}),e.jsx(U,{label:"Fulfillment *",htmlFor:"fulfillment_type",error:o.fulfillment_type,children:e.jsxs(re,{value:t.fulfillment_type,onValueChange:m=>i("fulfillment_type",m),children:[e.jsx(le,{children:e.jsx(oe,{placeholder:"Select fulfillment"})}),e.jsxs(ce,{children:[e.jsx(F,{value:"direct",children:"Direct"}),e.jsx(F,{value:"staff_assisted",children:"Staff Assisted"})]})]})}),e.jsx(U,{label:"Session *",htmlFor:"offering_session",error:o.offering_session,children:e.jsxs(re,{value:t.offering_session,onValueChange:m=>i("offering_session",m),children:[e.jsx(le,{children:e.jsx(oe,{placeholder:"Select session"})}),e.jsxs(ce,{children:[e.jsx(F,{value:"pre_checkin",children:"Pre Check-in"}),e.jsx(F,{value:"post_checkin",children:"Post Check-in"}),e.jsx(F,{value:"pre_checkout",children:"Pre Checkout"})]})]})})]})]})}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs(Me,{title:R||P?"Pricing":"Options",subtitle:R?"Set a single fixed price.":P?"Set unit name and price per unit.":V?"Guests select exactly one option.":g?"Guests can select more than one option.":W?"Complimentary service (price = 0).":"",bodyClassName:"max-h-[32vh]",children:[(R||P)&&e.jsxs("div",{className:"space-y-3",children:[R&&e.jsx(U,{label:"Price *",htmlFor:"price",error:o.price,children:e.jsx(K,{id:"price",type:"number",min:"0",step:"0.01",value:t.price,onChange:m=>i("price",m.target.value)})}),P&&e.jsxs(e.Fragment,{children:[e.jsx(U,{label:"Unit Name *",htmlFor:"unit_name",error:o.unit_name,children:e.jsx(K,{id:"unit_name",value:t.unit_name,onChange:m=>i("unit_name",m.target.value)})}),e.jsx(U,{label:"Price / Unit *",htmlFor:"price",error:o.price,children:e.jsx(K,{id:"price",type:"number",min:"0",step:"0.01",value:t.price,onChange:m=>i("price",m.target.value)})})]}),e.jsx(ms,{children:P?"Total is calculated at checkout based on quantity.":"Price shown to the guest at selection time."})]}),(V||g)&&e.jsxs("div",{className:"space-y-3",children:[t.options.map((m,p)=>e.jsx(tt,{mode:n,index:p,option:m,totalOptions:t.options.length,updateOption:f,removeOption:j,loadingImagesForEdit:ne,existingOptionImagesByKey:k,newOptionImagePreviews:A,handleReplaceOptionImageSafe:Ie,optionImageErrors:$},p)),e.jsx("div",{className:"flex justify-end",children:e.jsxs(I,{type:"button",variant:"outline",size:"sm",onClick:_,children:[e.jsx(De,{className:"h-4 w-4 mr-1"})," Add Option"]})}),o.options&&e.jsx("p",{className:"text-red-500 text-xs mt-1 text-right",children:o.options})]}),W&&e.jsx(ms,{children:"Complimentary service — price is fixed to 0."})]}),e.jsx(Me,{title:"Custom Questions",subtitle:"Ask guest-specific questions during ordering (optional).",bodyClassName:"max-h-[32vh]",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>me(m=>!m),className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 bg-muted",role:"switch","aria-checked":Q,children:e.jsx("span",{"aria-hidden":"true",className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-background shadow ring-0 transition duration-200 ease-in-out ${Q?"translate-x-5":"translate-x-0"}`})}),e.jsx("span",{className:"text-sm",children:"Enable custom questions"}),e.jsxs("div",{className:"ml-2 group relative",children:[e.jsx(ps,{className:"h-4 w-4 text-muted-foreground cursor-help"}),e.jsx("div",{className:"absolute hidden group-hover:block z-10 w-64 p-2 mt-1 text-xs bg-black text-white rounded-md shadow-lg",children:"Customers will be asked these questions during checkout."})]})]}),Q&&e.jsxs("div",{className:"space-y-2",children:[L.map((m,p)=>e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsx(K,{placeholder:`Question ${p+1}`,value:m,onChange:M=>z(p,M.target.value),className:"col-span-10"}),e.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:()=>Oe(p),disabled:L.length<=1,className:"col-span-2",children:e.jsx(pe,{className:"h-4 w-4"})})]},p)),e.jsx("div",{className:"flex justify-end",children:e.jsxs(I,{type:"button",variant:"outline",size:"sm",onClick:fe,children:[e.jsx(De,{className:"h-4 w-4 mr-1"})," Add Question"]})}),o.questions&&e.jsx("p",{className:"text-red-500 text-xs mt-1 text-right",children:o.questions})]})]})})]})]})}const at=({isOpen:n,onOpenChange:t,onConfirm:i,service:o})=>o?e.jsx(be,{open:n,onOpenChange:t,children:e.jsxs(ve,{children:[e.jsxs(ye,{children:[e.jsx(we,{children:"Confirm Deletion"}),e.jsxs(_e,{children:["Are you sure you want to delete the service"," ",e.jsx("strong",{children:o.name}),"? This action cannot be undone."]})]}),e.jsxs(Ee,{children:[e.jsx(I,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),e.jsx(I,{variant:"destructive",onClick:i,children:"Delete"})]})]})}):null,it=({paginationData:n,buildPaginationUrl:t})=>{const{from:i,to:o,total:_,prev_page_url:j,next_page_url:f}=n,u=x=>{x&&ie.get(t(x),{},{preserveState:!0,replace:!0})};return e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",i," to ",o," of ",_," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{variant:"outline",size:"sm",onClick:()=>u(j),disabled:!j,children:"Previous"}),e.jsx(I,{variant:"outline",size:"sm",onClick:()=>u(f),disabled:!f,children:"Next"})]})]})},rt=({popularService:n,profitableService:t,formatPrice:i})=>e.jsxs(je,{children:[e.jsxs(ke,{children:[e.jsx(Se,{children:"Highlight Layanan"}),e.jsx(Ce,{children:"Layanan paling populer dan paling menguntungkan."})]}),e.jsxs(Ne,{className:"space-y-4",children:[n?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"h-4 w-4 text-yellow-500"}),e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Paling Populer"})]}),e.jsx("p",{className:"text-lg font-semibold",children:n.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[n.orders_count," pesanan"]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Data populer tidak tersedia."}),e.jsx(Ls,{}),t?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qs,{className:"h-4 w-4 text-emerald-500"}),e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Paling Menguntungkan"})]}),e.jsx("p",{className:"text-lg font-semibold",children:t.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[i(t.revenue)," pendapatan"]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Data keuntungan tidak tersedia."})]})]});function lt({data:n}){const t=i=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(i);return e.jsxs(je,{className:"md:col-span-2",children:[e.jsxs(ke,{children:[e.jsx(Se,{children:"Layanan Terlaris"}),e.jsx(Ce,{children:"Peringkat berdasarkan pendapatan selama 7 hari terakhir"})]}),e.jsx(Ne,{children:e.jsxs(Re,{children:[e.jsx(ze,{children:e.jsxs(H,{children:[e.jsx(B,{className:"w-[80px]",children:"Peringkat"}),e.jsx(B,{children:"Nama Layanan"}),e.jsx(B,{className:"text-right",children:"Jumlah Pesanan"}),e.jsx(B,{className:"text-right",children:"Total Pendapatan"})]})}),e.jsx(Be,{children:n&&n.length>0?n.map(i=>e.jsxs(H,{children:[e.jsx(C,{className:"font-medium text-center",children:i.rank}),e.jsx(C,{className:"font-medium",children:i.serviceName}),e.jsx(C,{className:"text-right",children:i.orderCount}),e.jsx(C,{className:"text-right",children:t(i.totalRevenue)})]},i.rank)):e.jsx(H,{children:e.jsx(C,{colSpan:4,className:"h-24 text-center",children:"Belum ada data pendapatan layanan dalam 7 hari terakhir."})})})]})})]})}function ot({open:n,onOpenChange:t,serviceMeta:i}){const[o,_]=d.useState(!1),[j,f]=d.useState(null),[u,x]=d.useState([]),[N,k]=d.useState([]);d.useEffect(()=>{if(!n||!i?.id)return;(async()=>{_(!0),f(null);try{const y=await fetch(route("services.images",i.id),{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(!y.ok)throw new Error(`Request failed with status ${y.status}`);const b=await y.json();x(Array.isArray(b.images)?b.images:[]),k(Array.isArray(b.optionImages)?b.optionImages:[])}catch(y){console.error("Failed to load images",y),f("Couldn't load images for this service."),x([]),k([])}finally{_(!1)}})()},[n,i?.id]);const v=()=>e.jsx("div",{className:"w-24 h-24 rounded-md border bg-muted/40 relative overflow-hidden animate-pulse",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx($e,{className:"w-5 h-5 animate-spin text-muted-foreground/70"})})}),S=()=>e.jsxs("div",{className:"rounded-md border bg-white p-2 flex flex-col items-center animate-pulse",children:[e.jsx("div",{className:"w-24 h-24 flex-shrink-0 rounded-md overflow-hidden mb-2 bg-muted/40 relative",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx($e,{className:"w-5 h-5 animate-spin text-muted-foreground/70"})})}),e.jsxs("div",{className:"w-full flex flex-col items-center gap-1",children:[e.jsx("div",{className:"h-3 w-20 bg-muted/30 rounded"}),e.jsx("div",{className:"h-2 w-16 bg-muted/20 rounded"})]})]});return e.jsx(be,{open:n,onOpenChange:t,children:e.jsxs(ve,{className:"max-w-2xl max-h-[85vh] flex flex-col p-0 overflow-hidden",children:[e.jsx("div",{className:"px-5 py-4 border-b bg-gradient-to-br from-muted/30 to-background",children:e.jsxs(ye,{className:"space-y-1",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx(we,{className:"text-lg font-semibold",children:i?.name??"Service Images"})}),e.jsx(_e,{className:"text-sm text-muted-foreground",children:"Preview gallery for guest-facing view"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-5 py-4",children:e.jsxs("div",{className:"space-y-6",children:[j&&!o&&e.jsx("div",{className:"text-center py-3 px-4 bg-red-50 border border-red-100 rounded-md text-red-600",children:j}),e.jsxs("section",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold",children:"Service Images"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"General visuals"})]}),e.jsx(ee,{variant:"outline",children:"General"})]}),o?e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(v,{}),e.jsx(v,{}),e.jsx(v,{})]}):u.length===0?e.jsx("div",{className:"py-6 text-center text-muted-foreground border border-dashed rounded-md",children:"No general images uploaded."}):e.jsx("div",{className:"flex flex-wrap gap-3",children:u.map((h,y)=>e.jsx("div",{className:"w-24 h-24 rounded-md border bg-white shadow-sm overflow-hidden relative",children:e.jsx("img",{src:h.url??`/storage/${h.image_path}`,alt:h.caption||`Service image ${y+1}`,className:"object-cover w-full h-full"})},h.id??y))})]}),e.jsxs("section",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-base font-semibold",children:"Option Images"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Each option has its own thumbnail"})]}),e.jsx(ee,{variant:"outline",children:"Per Option"})]}),o?e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[e.jsx(S,{}),e.jsx(S,{})]}):N.length===0?e.jsx("div",{className:"py-6 text-center text-muted-foreground border border-dashed rounded-md",children:"No option-specific images uploaded."}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:N.map((h,y)=>e.jsxs("div",{className:"rounded-md border bg-white p-2 flex flex-col items-center",children:[e.jsx("div",{className:"w-24 h-24 flex-shrink-0 rounded-md overflow-hidden mb-2 bg-muted/20",children:e.jsx("img",{src:h.url??`/storage/${h.image_path}`,alt:h.option_name||"Option image",className:"object-contain w-full h-full"})}),e.jsxs("div",{className:"flex-1 min-w-0 w-full text-center",children:[e.jsx("div",{className:"font-medium text-slate-800 text-sm truncate",children:h.option_name||h.option_key||`Option ${y+1}`}),h.caption&&e.jsx("div",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:h.caption})]})]},h.id??y))})]})]})})]})})}function ct(){const{services:n,filters:t,flash:i,insights:o,filterOptions:_}=Fs().props,[j,f]=d.useState(t.search||""),[u,x]=d.useState(t.type||"all"),[N,k]=d.useState(t.fulfillment_type||"all"),[v,S]=d.useState(t.offering_session||"all"),[h,y]=d.useState(t.sort_by||"created_at"),[b,c]=d.useState(t.sort_direction||"desc"),[A,E]=d.useState(!1),[ue,G]=d.useState(!1),[de,se]=d.useState(!1),[ne,O]=d.useState(!1),[T,$]=d.useState(null),[te,ge]=d.useState(null),[Ie,Q]=d.useState([]),[me,L]=d.useState(0),[ae,V]=d.useState(!1),{data:g,setData:P,processing:R,errors:W,reset:xe,clearErrors:fe}=As({name:"",description:"",type:"fixed",fulfillment_type:"direct",offering_session:"post_checkin",price:"",unit_name:"",options:[{name:"",price:""}],has_questions:!1,questions:[""]}),[Oe,z]=d.useState([]),[m,p]=d.useState({}),[M,w]=d.useState([]),[Pe,he]=d.useState([]),[Fe,X]=d.useState([]),[Le,J]=d.useState([]),[Ae,Y]=d.useState({}),[Ue,Z]=d.useState({}),[He,Qe]=d.useState(!1),[Ve,We]=d.useState([""]);d.useEffect(()=>{i?.success&&rs.success(i.success),i?.error&&rs.error(i.error)},[i]),d.useEffect(()=>{const s=setTimeout(()=>gs(),500);return()=>clearTimeout(s)},[j,u,N,v,h,b]);const gs=(s=1)=>{ie.get(route("services.index"),{search:j,type:u==="all"?"":u,fulfillment_type:N==="all"?"":N,offering_session:v==="all"?"":v,sort_by:h,sort_direction:b,page:s},{preserveState:!0,replace:!0})},fs=s=>{y(s),c(b==="asc"?"desc":"asc")},js=s=>{$({id:s.id,name:s.name,type:s.type}),O(!0)},Ns=s=>{z(a=>a.filter(r=>r.id!==s)),w(a=>[...a,s])},bs=(s,a)=>{p(r=>{const l={...r};return l[a]&&(l[a]=l[a].filter(D=>D.id!==s)),l}),he(r=>[...r,s])},Xe=s=>{J(a=>a.filter((r,l)=>l!==s)),X(a=>a.filter((r,l)=>l!==s))},Je=(s,a)=>{const r=a?.[0];r&&(Y(l=>({...l,[s]:r})),Z(l=>({...l,[s]:URL.createObjectURL(r)})))},Ye=s=>{const a=Array.from(s||[]);if(!a.length)return;const r=a.map(l=>({file:l,url:URL.createObjectURL(l)}));X(l=>[...l,...a]),J(l=>[...l,...r])},vs=()=>{xe(),fe(),P({name:"",description:"",type:"fixed",fulfillment_type:"direct",offering_session:"post_checkin",price:"",unit_name:"",options:[{name:"",price:""}],has_questions:!1,questions:[""]}),z([]),p({}),w([]),he([]),X([]),J([]),Y({}),Z({}),Qe(!1),We([""]),L(s=>s+1),E(!0)},ys=s=>{G(!0),ge(s),fe(),P({name:s.name,description:s.description||"",type:s.type,fulfillment_type:s.fulfillment_type,offering_session:s.offering_session||"post_checkin",price:s.price||"",unit_name:s.unit_name||"",options:s.options&&s.options.length>0?s.options:[{name:"",price:""}],has_questions:s.has_active_questions||!1,questions:s.active_question?.questions_json||[""]}),Qe(s.has_active_questions||!1),We(s.active_question?.questions_json||[""]),z([]),p({}),w([]),he([]),X([]),J([]),Y({}),Z({}),V(!0),L(a=>a+1),(async()=>{try{const a=await fetch(route("services.images",s.id),{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(a.ok){const r=await a.json(),l=Array.isArray(r.images)?r.images:[],D=Array.isArray(r.optionImages)?r.optionImages:[],q={};D.forEach(is=>{const qe=is.option_key||"unknown";q[qe]||(q[qe]=[]),q[qe].push(is)}),z(l),p(q)}else z([]),p({})}catch(a){console.error("Failed loading service images",a),z([]),p({})}finally{V(!1)}})()},ws=s=>{ge(s),se(!0)},_s=s=>Q(a=>a.includes(s)?a.filter(r=>r!==s):[...a,s]),Ze=()=>{P("options",[...g.options,{name:"",price:""}])},Ke=s=>{if(g.options.length<=1)return;const r=g.options[s].key||`opt_${s+1}`,l=g.options.filter((D,q)=>q!==s);P("options",l),p(D=>{const q={...D};return delete q[r],q}),Y(D=>{const q={...D};return delete q[r],q}),Z(D=>{const q={...D};return delete q[r],q})},es=(s,a,r)=>{const l=[...g.options];l[s][a]=r,P("options",l)},ks=()=>{f(""),x("all"),k("all"),S("all"),y("created_at"),c("desc")},ss=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s||0),Ss=(s,a)=>{let r=s;switch(s){case"fixed":r="Fixed";break;case"per_unit":r=`Per Unit ${a?`(${a})`:""}`;break;case"selectable":r="Select";break;case"multiple_options":r="Multi-Select";break;default:r=s}const D={fixed:"bg-blue-100 text-blue-800 border-blue-200",per_unit:"bg-emerald-100 text-emerald-800 border-emerald-200",selectable:"bg-violet-100 text-violet-800 border-violet-200",multiple_options:"bg-fuchsia-100 text-fuchsia-800 border-fuchsia-200",free:"bg-rose-100 text-rose-800 border-rose-200"}[s]||"bg-gray-100 text-gray-800 border-gray-200";return e.jsx(ee,{className:`capitalize text-xs font-medium w-28 justify-center ${D}`,variant:"outline",children:r})},Cs=s=>{let a=s;switch(s){case"direct":a="Direct";break;case"staff_assisted":a="Staff Assisted";break;default:a=s}const l={direct:"bg-slate-100 text-slate-800 border-slate-200",staff_assisted:"bg-amber-100 text-amber-800 border-amber-200"}[s]||"bg-gray-100 text-gray-800 border-gray-200";return e.jsx(ee,{className:`capitalize text-xs font-medium w-32 justify-center ${l}`,variant:"outline",children:a})},Is=s=>{let a=s?s.replace("_"," "):"N/A";switch(s){case"pre_checkin":a="Pre Check-in";break;case"post_checkin":a="Post Check-in";break;case"pre_checkout":a="Pre Checkout";break;case"free":a="Free";break;default:a=s}const l={pre_checkin:"bg-indigo-100 text-indigo-800 border-indigo-200",post_checkin:"bg-green-100 text-green-800 border-green-200",pre_checkout:"bg-orange-100 text-orange-800 border-orange-200",free:"bg-rose-100 text-rose-800 border-rose-200"}[s]||"bg-gray-100 text-gray-800 border-gray-200";return e.jsx(ee,{className:`capitalize text-xs font-medium w-32 justify-center ${l}`,variant:"outline",children:a})},Os=s=>{if(!s)return null;const a=new URL(s),r=new URLSearchParams(a.search);return r.set("search",j),r.set("type",u==="all"?"":u),r.set("fulfillment_type",N==="all"?"":N),r.set("offering_session",v==="all"?"":v),r.set("sort_by",h),r.set("sort_direction",b),`${a.pathname}?${r.toString()}`},ts=(s=!1)=>{const a=new FormData;return s&&a.append("_method","PUT"),a.append("name",g.name??""),a.append("description",g.description??""),a.append("type",g.type??""),a.append("fulfillment_type",g.fulfillment_type??""),a.append("offering_session",g.offering_session??""),a.append("price",g.price??""),a.append("unit_name",g.unit_name??""),a.append("has_questions",g.has_questions?"1":"0"),g.has_questions&&Array.isArray(g.questions)&&g.questions.forEach((r,l)=>{a.append(`questions[${l}]`,r??"")}),Array.isArray(g.options)&&g.options.forEach((r,l)=>{a.append(`options[${l}][name]`,r.name??""),a.append(`options[${l}][price]`,r.price??""),r.key&&a.append(`options[${l}][key]`,r.key)}),M.forEach((r,l)=>{a.append(`images_to_delete[${l}]`,r)}),Pe.forEach((r,l)=>{a.append(`option_images_to_delete[${l}]`,r)}),Fe.forEach((r,l)=>{r&&a.append(`images[${l}]`,r)}),Object.entries(Ae).forEach(([r,l])=>{l&&(s?a.append(`option_images_new[${r}]`,l):a.append(`option_images[${r}]`,l))}),a},ns=s=>{s.preventDefault();const a=ts(!1);ie.post(route("services.store"),a,{forceFormData:!0,onSuccess:()=>{E(!1),xe(),z([]),p({}),w([]),he([]),X([]),J([]),Y({}),Z({}),L(r=>r+1)}})},as=s=>{s.preventDefault();const a=ts(!0);ie.post(route("services.update",te.id),a,{forceFormData:!0,onSuccess:()=>{G(!1),xe(),z([]),p({}),w([]),he([]),X([]),J([]),Y({}),Z({}),L(r=>r+1)},onError:()=>{}})},Ps=()=>{ie.delete(route("services.destroy",te.id),{onSuccess:()=>se(!1)})};return e.jsxs("div",{className:"container mx-auto py-2 px-4",children:[e.jsxs(je,{className:"mb-8",children:[e.jsx(Ys,{onAddService:vs}),e.jsxs(Ne,{children:[e.jsx(Zs,{searchTerm:j,setSearchTerm:f,selectedType:u,setSelectedType:x,selectedFulfillment:N,setSelectedFulfillment:k,selectedOfferingSession:v,setSelectedOfferingSession:S,clearFilters:ks,filterOptions:_}),e.jsx(et,{services:n.data,expandedRows:Ie,toggleRow:_s,openEditModal:ys,openDeleteModal:ws,openImagesModal:js,formatPrice:ss,sortBy:h,sortDirection:b,handleSort:fs,getTypeBadge:Ss,getFulfillmentBadge:Cs,getOfferingSessionBadge:Is}),e.jsx(it,{paginationData:n,buildPaginationUrl:Os,router:ie})]})]}),e.jsxs(je,{children:[e.jsxs(ke,{children:[e.jsx(Se,{className:"text-2xl font-bold",children:"Services Insights"}),e.jsx(Ce,{children:"Insights from your services data"})]}),e.jsxs(Ne,{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(rt,{popularService:o.mostPopular,profitableService:o.highestRevenue,formatPrice:ss}),e.jsx(lt,{data:o.topServices})]})]}),e.jsx(be,{open:A,onOpenChange:E,children:e.jsxs(ve,{className:"w-[96vw] sm:max-w-[1200px] lg:max-w-[1400px] max-h-[88vh]",children:[e.jsxs(ye,{children:[e.jsx(we,{children:"Create New Service"}),e.jsx(_e,{children:"Add a new service to your offerings"})]}),e.jsx("div",{className:"overflow-auto pr-1",style:{maxHeight:"68vh"},children:e.jsx("form",{onSubmit:ns,children:e.jsx(xs,{mode:"create",data:g,setData:P,errors:W,addOption:Ze,removeOption:Ke,updateOption:es,initialHasQuestions:He,initialQuestions:Ve,existingGeneralImages:[],existingOptionImagesByKey:{},markDeleteGeneralImage:()=>{},markDeleteOptionImage:()=>{},newGeneralImages:Fe,newGeneralPreviews:Le,setNewGeneralImages:X,setNewGeneralPreviews:J,newOptionImages:Ae,newOptionImagePreviews:Ue,setNewOptionImages:Y,setNewOptionImagePreviews:Z,handleReplaceOptionImage:Je,addNewGeneralImages:Ye,removeNewGeneralPreview:Xe,loadingImagesForEdit:!1},`create-${me}`)})}),e.jsx(Ee,{className:"mt-2",children:e.jsx(I,{type:"submit",disabled:R,onClick:ns,children:"Create Service"})})]})}),e.jsx(be,{open:ue,onOpenChange:G,children:e.jsxs(ve,{className:"w-[96vw] sm:max-w-[1200px] lg:max-w-[1400px] max-h-[88vh]",children:[e.jsxs(ye,{children:[e.jsx(we,{children:"Edit Service"}),e.jsx(_e,{children:"Update service information"})]}),e.jsx("div",{className:"overflow-auto pr-1",style:{maxHeight:"68vh"},children:e.jsx("form",{onSubmit:as,children:e.jsx(xs,{mode:"edit",data:g,setData:P,errors:W,addOption:Ze,removeOption:Ke,updateOption:es,initialHasQuestions:He,initialQuestions:Ve,existingGeneralImages:Oe,existingOptionImagesByKey:m,markDeleteGeneralImage:Ns,markDeleteOptionImage:bs,newGeneralImages:Fe,newGeneralPreviews:Le,setNewGeneralImages:X,setNewGeneralPreviews:J,newOptionImages:Ae,newOptionImagePreviews:Ue,setNewOptionImages:Y,setNewOptionImagePreviews:Z,handleReplaceOptionImage:Je,addNewGeneralImages:Ye,removeNewGeneralPreview:Xe,loadingImagesForEdit:ae},`edit-${me}`)})}),e.jsx(Ee,{className:"mt-2",children:e.jsx(I,{type:"submit",disabled:R,onClick:as,children:"Update Service"})})]})}),e.jsx(at,{isOpen:de,onOpenChange:se,onConfirm:Ps,service:te}),e.jsx(ot,{open:ne,onOpenChange:O,serviceMeta:T})]})}ct.layout=n=>e.jsx($s,{children:n});export{ct as default};
