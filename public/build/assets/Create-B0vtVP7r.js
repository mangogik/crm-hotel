import{u as A,r as c,j as r,H as G,L as D}from"./app-DJl2ydn2.js";import{A as E}from"./AuthenticatedLayout-C8pa3ZP2.js";import{S as F}from"./ServiceForm-CVYH1P3m.js";import{B as y}from"./button-BcKuhJzw.js";import{C as L,a as $,b as P,d as R}from"./card-q4U6RwoP.js";/* empty css            */import"./index-DjLYN8p0.js";import"./index-CNtyiCxP.js";import"./input-ksvuRPG_.js";import"./label-xh0tx8M8.js";import"./select-D32KVn18.js";import"./index-2z52CgDs.js";import"./chevron-down-lmp7wB3O.js";import"./plus-p-3jHoRd.js";import"./circle-question-mark-t8hdwJg1.js";import"./image-C4tNnfhw.js";import"./loader-circle-CjFAv75S.js";import"./arrow-right-Ds5sFVJ9.js";function ie({categories:_}){const{data:s,setData:a,post:v,processing:f,errors:w}=A({name:"",description:"",type:"fixed",fulfillment_type:"direct",offering_session:"post_checkin",price:"",unit_name:"",options:[{name:"",price:""}],has_questions:!1,questions:[""],category_id:null}),[g,m]=c.useState([]),[x,d]=c.useState([]),[h,l]=c.useState({}),[j,u]=c.useState({}),O=()=>{a("options",[...s.options,{name:"",price:""}])},S=e=>{if(s.options.length<=1)return;const n=s.options[e].key||`opt_${e+1}`,i=s.options.filter((p,o)=>o!==e);a("options",i),l(p=>{const o={...p};return delete o[n],o}),u(p=>{const o={...p};return delete o[n],o})},I=(e,t,n)=>{const i=[...s.options];i[e][t]=n,a("options",i)},C=e=>{d(t=>t.filter((n,i)=>i!==e)),m(t=>t.filter((n,i)=>i!==e))},N=(e,t)=>{const n=t?.[0];n&&(l(i=>({...i,[e]:n})),u(i=>({...i,[e]:URL.createObjectURL(n)})))},b=e=>{const t=Array.from(e||[]);if(!t.length)return;const n=t.map(i=>({file:i,url:URL.createObjectURL(i)}));m(i=>[...i,...t]),d(i=>[...i,...n])},k=()=>{const e=new FormData;return e.append("name",s.name??""),e.append("description",s.description??""),e.append("type",s.type??""),e.append("category_id",s.category_id??""),e.append("fulfillment_type",s.fulfillment_type??""),e.append("offering_session",s.offering_session??""),e.append("price",s.price??""),e.append("unit_name",s.unit_name??""),e.append("has_questions",s.has_questions?"1":"0"),s.has_questions&&Array.isArray(s.questions)&&s.questions.forEach((t,n)=>{e.append(`questions[${n}]`,t??"")}),Array.isArray(s.options)&&s.options.forEach((t,n)=>{e.append(`options[${n}][name]`,t.name??""),e.append(`options[${n}][price]`,t.price??""),t.key&&e.append(`options[${n}][key]`,t.key)}),g.forEach((t,n)=>{t&&e.append(`images[${n}]`,t)}),Object.entries(h).forEach(([t,n])=>{n&&e.append(`option_images[${t}]`,n)}),e},q=e=>{e.preventDefault();const t=k();v(route("services.store"),{data:t,forceFormData:!0,onSuccess:()=>{}})};return r.jsxs(E,{children:[r.jsx(G,{title:"Create New Service"}),r.jsx("div",{className:"container mx-auto py-2 px-4",children:r.jsx("form",{onSubmit:q,children:r.jsxs(L,{children:[r.jsxs($,{className:"flex flex-row items-center justify-between",children:[r.jsx("div",{children:r.jsx(P,{children:"Create New Service"})}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx(D,{href:route("services.index"),children:r.jsx(y,{type:"button",variant:"outline",children:"Cancel"})}),r.jsx(y,{type:"submit",disabled:f,children:f?"Saving...":"Create Service"})]})]}),r.jsx(R,{children:r.jsx(F,{mode:"create",data:s,setData:a,categories:_||[],errors:w,addOption:O,removeOption:S,updateOption:I,initialHasQuestions:!1,initialQuestions:[""],existingGeneralImages:[],existingOptionImagesByKey:{},markDeleteGeneralImage:()=>{},markDeleteOptionImage:()=>{},newGeneralImages:g,newGeneralPreviews:x,setNewGeneralImages:m,setNewGeneralPreviews:d,newOptionImages:h,newOptionImagePreviews:j,setNewOptionImages:l,setNewOptionImagePreviews:u,handleReplaceOptionImage:N,addNewGeneralImages:b,removeNewGeneralPreview:C,loadingImagesForEdit:!1})})]})})})]})}export{ie as default};
