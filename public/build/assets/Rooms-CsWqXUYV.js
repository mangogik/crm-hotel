import{j as e,r as c,u as he,b as E,c as Be}from"./app-AyfoWOf7.js";import{P as Te,T as Re,t as ve}from"./index-uF_CP_2T.js";import{X as pe,d as Le,H as Ge,A as ze}from"./AuthenticatedLayout-CWdU4vaa.js";import{a as ge,b as je,c as fe,C as oe,d as Ne}from"./card-AZOavDqy.js";import{S as Ve,A as Ee,D as L,b as G,c as z,d as V,e as ie,f as ye}from"./dialog-CXcK20gv.js";import{c as He,B as N}from"./button-BQewrBSE.js";import{P as be}from"./plus-0Qvt8Q3j.js";import{I as re,L as P}from"./label-DD35oVQK.js";import{S as J,a as X,b as K,c as Z,d as k}from"./select-vsK93IMx.js";import{F as _e}from"./funnel-DzxNHDw1.js";import{T as W,a as v,b as De,c as Pe,d as B,e as ke}from"./table-CyulltmA.js";import{B as Ae}from"./badge-Iuivjzy_.js";import{C as Ue}from"./chevron-down-DEv-iym4.js";import{I as Ye}from"./images-CzQ-YqwE.js";import{I as We}from"./image-D5GKoN6_.js";import{L as Me}from"./loader-circle-C1QjoT64.js";/* empty css            */import"./index-DaYjVfwV.js";import"./index-DSwpZHfu.js";import"./index-kg_FVPZ1.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Je=He("circle-alert",qe),Xe=({onAddRoom:r})=>e.jsx(ge,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(je,{className:"text-2xl font-bold",children:"Rooms"}),e.jsx(fe,{children:"Manage your hotel rooms and room types"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(N,{onClick:r,className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"})," Add Room"]})})]})}),Ke=({searchTerm:r,setSearchTerm:a,selectedStatus:i,setSelectedStatus:x,selectedTypeId:l,setSelectedTypeId:d,roomTypes:u=[],clearFilters:h})=>{const n=["all","available","occupied","maintenance"],m=s=>s&&s.charAt(0).toUpperCase()+s.slice(1);return e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ve,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(re,{placeholder:"Search by room number or type...",value:r,onChange:s=>a(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(J,{value:String(l||"all"),onValueChange:s=>d(s==="all"?"all":s),children:[e.jsxs(X,{className:"w-full md:w-[220px]",children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),e.jsx(K,{placeholder:"Room Type"})]}),e.jsxs(Z,{children:[e.jsx(k,{value:"all",children:"All Types"}),u.map(s=>e.jsx(k,{value:String(s.id),children:s.name},s.id))]})]}),e.jsxs(J,{value:i,onValueChange:x,children:[e.jsxs(X,{className:"w-full md:w-[200px]",children:[e.jsx(_e,{className:"mr-2 h-4 w-4"}),e.jsx(K,{placeholder:"Status"})]}),e.jsx(Z,{children:n.map(s=>e.jsx(k,{value:s,children:s==="all"?"All Statuses":m(s)},s))})]}),e.jsxs(N,{variant:"outline",onClick:h,className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-4 w-4"})," Clear"]})]})]})},Ze=({room:r,isExpanded:a,onToggle:i,onEdit:x,onDelete:l,onOpenImages:d})=>{const u=m=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:0}).format(m??0),h=m=>{switch(m){case"available":return"success";case"occupied":return"destructive";case"maintenance":return"warning";default:return"outline"}},n=r.room_type;return e.jsxs(e.Fragment,{children:[e.jsxs(W,{className:"cursor-pointer hover:bg-muted/50",onClick:i,children:[e.jsx(v,{children:e.jsx(N,{variant:"ghost",size:"sm",children:a?e.jsx(Ue,{className:"h-4 w-4"}):e.jsx(Le,{className:"h-4 w-4"})})}),e.jsx(v,{className:"font-medium",children:r.room_number}),e.jsx(v,{children:n?.name??"-"}),e.jsx(v,{children:n?.capacity!=null?`${n.capacity} People`:"-"}),e.jsx(v,{children:n?.price_per_night!=null?u(n.price_per_night):"-"}),e.jsx(v,{children:e.jsx(Ae,{variant:h(r.status),className:"capitalize",children:r.status})}),e.jsx(v,{onClick:m=>m.stopPropagation(),children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(N,{variant:"ghost",size:"sm",onClick:x,className:"bg-secondary text-secondary-foreground",children:e.jsx(Te,{className:"h-4 w-4"})}),e.jsx(N,{variant:"ghost",size:"sm",onClick:l,className:"bg-destructive text-destructive-foreground",children:e.jsx(Re,{className:"h-4 w-4"})})]})})]}),a&&e.jsx(W,{children:e.jsx(v,{colSpan:7,className:"p-4 bg-muted/20",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.images?.length||0," images assigned to this room."]}),e.jsxs(N,{variant:"outline",size:"sm",className:"flex items-center gap-2 text-xs",onClick:m=>{m.stopPropagation(),d(r)},children:[e.jsx(Ye,{className:"h-4 w-4"}),"View Images"]})]})})},`${r.id}-details`)]})},Qe=({rooms:r,expandedRows:a,toggleRow:i,openEditModal:x,openDeleteModal:l,openImagesModal:d,sortBy:u,sortDirection:h,handleSort:n})=>{const m=({field:s,children:y})=>e.jsx(B,{className:"cursor-pointer",onClick:()=>n(s),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:y}),u===s&&e.jsx(Ee,{className:`h-3 w-3 ${h==="asc"?"":"rotate-180"}`})]})});return e.jsx("div",{className:"rounded-md border",children:e.jsxs(De,{children:[e.jsx(Pe,{children:e.jsxs(W,{children:[e.jsx(B,{className:"w-8"}),e.jsx(m,{field:"room_number",children:"Room Number"}),e.jsx(m,{field:"room_type",children:"Type"}),e.jsx(B,{children:"Capacity"}),e.jsx(B,{children:"Price/Night"}),e.jsx(m,{field:"status",children:"Status"}),e.jsx(B,{children:"Actions"})]})}),e.jsx(ke,{children:r.length>0?r.map(s=>e.jsx(Ze,{room:s,isExpanded:a.includes(s.id),onToggle:()=>i(s.id),onEdit:()=>x(s),onDelete:()=>l(s),onOpenImages:()=>d(s)},s.id)):e.jsx(W,{children:e.jsx(v,{colSpan:7,className:"text-center py-8",children:"No rooms found"})})})]})})},ce=({data:r,setData:a,errors:i})=>{const x=[{id:"name",label:"Name *",type:"text",placeholder:"e.g., Standard, Deluxe"},{id:"capacity",label:"Capacity *",type:"number",min:1,placeholder:"Guests"},{id:"price_per_night",label:"Price per Night *",type:"number",min:0,step:"0.01",placeholder:"0.00"}];return e.jsx("div",{className:"grid gap-4 py-4",children:x.map(l=>e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(P,{htmlFor:l.id,className:"text-right",children:l.label}),e.jsx(re,{id:l.id,type:l.type,value:r[l.id]??"",onChange:d=>a(l.id,d.target.value),className:"col-span-3",placeholder:l.placeholder,...l.min!==void 0?{min:l.min}:{},...l.step!==void 0?{step:l.step}:{}}),i?.[l.id]&&e.jsx("p",{className:"text-red-500 text-sm col-span-4 text-right",children:i[l.id]})]},l.id))})},es=2*1024*1024,ss=["image/jpeg","image/jpg","image/png","image/webp"],we=({size:r="w-16 h-16"})=>e.jsx("div",{className:`${r} rounded-md border bg-muted/40 animate-pulse flex items-center justify-center text-[10px] text-muted-foreground`,children:e.jsx(Me,{className:"w-4 h-4 animate-spin opacity-60"})});function Se({mode:r,existingGeneralImages:a=[],newGeneralPreviews:i=[],onDeleteExisting:x,onDeleteNew:l,onAddNewSafe:d,localError:u,loadingImagesForEdit:h=!1}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[r==="edit"&&h&&e.jsxs(e.Fragment,{children:[e.jsx(we,{}),e.jsx(we,{})]}),r==="edit"&&!h&&a.length>0&&a.map(n=>e.jsxs("div",{className:"relative w-16 h-16 border rounded-md bg-white shadow-sm overflow-hidden",children:[e.jsx("img",{src:n.url??`/storage/${n.image_path}`,alt:n.caption||"room image",className:"object-cover w-full h-full"}),e.jsx("button",{type:"button",className:"absolute top-0 right-0 bg-red-600 text-white rounded-bl-md px-1 py-[2px] text-[10px] flex items-center gap-1",onClick:()=>x(n.id),title:"Remove this image",children:e.jsx(pe,{className:"w-3 h-3"})})]},n.id)),i.length>0&&i.map((n,m)=>e.jsxs("div",{className:"relative w-16 h-16 border rounded-md bg-white ring-2 ring-purple-500/40 shadow-sm overflow-hidden",children:[e.jsx("img",{src:n.url,alt:n.file?.name||"new image",className:"object-cover w-full h-full"}),e.jsx("button",{type:"button",className:"absolute top-0 right-0 bg-purple-600 text-white rounded-bl-md px-1 py-[2px] text-[10px] flex items-center gap-1",onClick:()=>l(m),title:"Remove this new image",children:e.jsx(pe,{className:"w-3 h-3"})}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-purple-600 text-white text-[9px] leading-tight px-1 py-[2px] text-center",children:"new"})]},`new-${m}`))]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("label",{className:"inline-flex items-center gap-1 px-2 py-1.5 text-xs border rounded-md bg-white hover:bg-muted cursor-pointer w-fit",children:[e.jsx("input",{type:"file",multiple:!0,accept:"image/*",className:"hidden",onChange:n=>d(n.target.files)}),e.jsx(We,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Add Images"})]}),u?e.jsx("div",{className:"text-[10px] text-red-600 leading-tight",children:u}):e.jsx("div",{className:"text-[10px] text-muted-foreground leading-tight",children:"JPG / PNG / WebP â€¢ max 2MB each."})]})]})}const Ce=({roomTypes:r=[],initialData:a=null,onSuccess:i,onCancel:x,onModeChange:l})=>{const[d,u]=c.useState(!1),[h,n]=c.useState(!1),[m,s]=c.useState(""),y=!!a,{data:o,setData:j,post:Q,processing:S,errors:C,reset:I}=he({is_range:!1,room_number:a?.room_number||"",start_room:"",end_room:"",room_type_id:a?.room_type_id||a?.room_type?.id||"",status:a?.status||"available",images:[],images_to_delete:[],_existingImages:a?.images||[],_newImagePreviews:[]});c.useEffect(()=>{l&&l(d)},[d,l]),c.useEffect(()=>{j({is_range:!1,room_number:a?.room_number||"",start_room:"",end_room:"",room_type_id:a?.room_type_id||a?.room_type?.id||"",status:a?.status||"available",images:[],images_to_delete:[],_existingImages:a?.images||[],_newImagePreviews:[]}),s("")},[a]);const ee=t=>{u(t),j("is_range",t),t?j("room_number",""):(j("start_room",""),j("end_room",""))},A=t=>{if(!t||!t.length)return;const g=[],w=[];let b="";Array.from(t).forEach(_=>{if(_.size>es){b="One or more images exceed 2MB.";return}if(!ss.includes(_.type)){b="Only JPG, PNG, or WebP images are allowed.";return}g.push(_),w.push({file:_,url:URL.createObjectURL(_)})}),s(b||""),g.length>0&&j(_=>({..._,images:[..._.images,...g],_newImagePreviews:[..._._newImagePreviews,...w]}))},M=t=>{j(g=>({...g,images:g.images.filter((w,b)=>b!==t),_newImagePreviews:g._newImagePreviews.filter((w,b)=>b!==t)}))},T=t=>{j(g=>({...g,images_to_delete:[...g.images_to_delete,t],_existingImages:g._existingImages.filter(w=>w.id!==t)}))},q=t=>{t.preventDefault();const g={...o};delete g._existingImages,delete g._newImagePreviews,y?E.post(route("rooms.update",a.id),{_method:"PUT",...g},{onSuccess:()=>{I(),i()},onError:()=>{j("_existingImages",a?.images||[])}}):Q(route("rooms.store"),{data:g,onSuccess:()=>{I(),i()}})},O=()=>{I(),x()},H=(()=>{if(!d||!o.start_room||!o.end_room)return 0;const t=o.start_room.match(/^([^\d]*)(\d+)$/),g=o.end_room.match(/^([^\d]*)(\d+)$/);if(t&&g&&t[1]===g[1]){const w=parseInt(t[2]),b=parseInt(g[2]);return Math.max(0,b-w+1)}return!isNaN(o.start_room)&&!isNaN(o.end_room)?Math.max(0,parseInt(o.end_room)-parseInt(o.start_room)+1):0})(),U=()=>{n(!1),E.reload({only:["roomTypes"]})},R=c.useMemo(()=>{if(!o.room_type_id)return!1;if(y){if(o._existingImages.length+o.images.length===0)return!1}else if(o.images.length===0)return!1;if(d){if(!o.start_room.trim()||!o.end_room.trim())return!1}else if(!o.room_number.trim())return!1;return!0},[y,d,o.room_number,o.start_room,o.end_room,o.room_type_id,o.images.length,o._existingImages.length]);return e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[!d&&e.jsxs(oe,{children:[e.jsxs(ge,{className:"pb-4",children:[e.jsxs(je,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-5 w-5"}),y?"Edit Single Room":"Create Single Room"]}),e.jsx(fe,{children:y?`Editing room ${a.room_number}`:"Create a single room"})]}),e.jsxs(Ne,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(P,{htmlFor:"room_number",className:"text-right",children:"Room Number *"}),e.jsx(re,{id:"room_number",value:o.room_number,onChange:t=>j("room_number",t.target.value),className:"col-span-3",placeholder:"e.g., 101, A201"}),C.room_number&&e.jsx("p",{className:"text-red-500 text-sm col-span-4 text-right",children:C.room_number})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(P,{htmlFor:"room_type_id",className:"text-right",children:"Room Type *"}),e.jsxs("div",{className:"col-span-3 flex gap-2",children:[e.jsxs(J,{value:String(o.room_type_id||""),onValueChange:t=>j("room_type_id",t===""?null:Number(t)),children:[e.jsx(X,{className:"flex-1",children:e.jsx(K,{placeholder:"Select type"})}),e.jsx(Z,{children:r.map(t=>e.jsx(k,{value:String(t.id),children:t.name},t.id))})]}),e.jsx(N,{type:"button",variant:"outline",onClick:()=>n(!0),children:"Add Type"})]}),C.room_type_id&&e.jsx("p",{className:"text-red-500 text-sm col-span-4 text-right",children:C.room_type_id})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(P,{htmlFor:"status",className:"text-right",children:"Status *"}),e.jsxs(J,{value:o.status||"available",onValueChange:t=>j("status",t),children:[e.jsx(X,{className:"col-span-3",children:e.jsx(K,{placeholder:"Select status"})}),e.jsxs(Z,{children:[e.jsx(k,{value:"available",children:"Available"}),e.jsx(k,{value:"maintenance",children:"Maintenance"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-start gap-4",children:[e.jsx(P,{htmlFor:"images",className:"text-right pt-2",children:"Images *"}),e.jsx("div",{className:"col-span-3",children:e.jsx(Se,{mode:y?"edit":"create",existingGeneralImages:o._existingImages,newGeneralPreviews:o._newImagePreviews,onDeleteExisting:T,onDeleteNew:M,onAddNewSafe:A,localError:m||C.images})})]})]})]}),d&&e.jsxs(oe,{children:[e.jsxs(ge,{className:"pb-4",children:[e.jsxs(je,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5"}),"Bulk Room Creation"]}),e.jsx(fe,{children:"Create multiple rooms at once"})]}),e.jsx(Ne,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Room Number Range"}),H>0&&e.jsxs(Ae,{variant:"secondary",className:"text-xs",children:[H," rooms"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"start_room",className:"text-xs font-medium",children:"Start *"}),e.jsx(re,{id:"start_room",value:o.start_room,onChange:t=>j("start_room",t.target.value),className:"h-8 text-sm",placeholder:"e.g., 101"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"end_room",className:"text-xs font-medium",children:"End *"}),e.jsx(re,{id:"end_room",value:o.end_room,onChange:t=>j("end_room",t.target.value),className:"h-8 text-sm",placeholder:"e.g., 110"})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Specifications"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"room_type_id_bulk",className:"text-xs font-medium",children:"Type *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(J,{value:String(o.room_type_id||""),onValueChange:t=>j("room_type_id",t===""?null:Number(t)),children:[e.jsx(X,{className:"h-8 text-sm flex-1",children:e.jsx(K,{placeholder:"Select type"})}),e.jsx(Z,{children:r.map(t=>e.jsx(k,{value:String(t.id),children:t.name},t.id))})]}),e.jsx(N,{type:"button",variant:"outline",size:"sm",onClick:()=>n(!0),children:"Add Type"})]})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"status_bulk",className:"text-xs font-medium",children:"Status *"}),e.jsxs(J,{value:o.status||"available",onValueChange:t=>j("status",t),children:[e.jsx(X,{className:"h-8 text-sm",children:e.jsx(K,{placeholder:"Status"})}),e.jsxs(Z,{children:[e.jsx(k,{value:"available",children:"Available"}),e.jsx(k,{value:"maintenance",children:"Maintenance"})]})]})]})]})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("h4",{className:"font-medium text-sm mb-2",children:"Images *"}),e.jsx(Se,{mode:"create",existingGeneralImages:[],newGeneralPreviews:o._newImagePreviews,onDeleteExisting:()=>{},onDeleteNew:M,onAddNewSafe:A,localError:m||C.images}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Images added here will be applied to ALL rooms created in this batch."})]})]})})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[!y&&e.jsxs(oe,{className:"flex flex-row items-center space-x-2 p-2 rounded-lg",children:[e.jsx("span",{className:`text-sm ${d?"font-medium":"text-muted-foreground"}`,children:"Bulk Rooms"}),e.jsx("button",{type:"button",onClick:()=>ee(!d),className:"relative inline-flex h-6 w-11 flex-shrink-0 cursor-pointer rounded-full border-2 border-transparent transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 bg-muted",role:"switch","aria-checked":d,children:e.jsx("span",{"aria-hidden":"true",className:`pointer-events-none inline-block h-5 w-5 transform rounded-full bg-background shadow ring-0 transition duration-200 ease-in-out ${d?"translate-x-5":"translate-x-0"}`})})]}),y&&e.jsx("div",{}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(N,{type:"button",variant:"outline",onClick:O,children:"Cancel"}),e.jsx(N,{type:"submit",disabled:S||!R,children:S?"Saving...":y?"Update Room":"Create Room"})]})]})]}),e.jsx(L,{open:h,onOpenChange:n,children:e.jsxs(G,{className:"sm:max-w-md",children:[e.jsx(z,{children:e.jsx(V,{children:"Add Room Type"})}),e.jsx(ce,{onSuccess:U,onCancel:()=>n(!1)})]})})]})},Oe=({isOpen:r,onOpenChange:a,onConfirm:i,room:x,entityLabel:l,entityValue:d})=>{const u=l??(x?"Room":"Item"),h=d??(x?x.room_number:"");return e.jsx(L,{open:r,onOpenChange:a,children:e.jsxs(G,{children:[e.jsxs(z,{children:[e.jsx(V,{children:"Confirm Deletion"}),e.jsxs(ie,{children:["Are you sure you want to delete ",u,h?" ":"",h&&e.jsx("strong",{children:h}),"? This action cannot be undone."]})]}),e.jsxs(ye,{children:[e.jsx(N,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(N,{variant:"destructive",onClick:i,children:"Delete"})]})]})})},ts=({paginationData:r,buildPaginationUrl:a,router:i})=>{const{from:x,to:l,total:d,prev_page_url:u,next_page_url:h}=r,n=m=>{m&&i.get(a(m),{},{preserveState:!0,replace:!0})};return e.jsxs("div",{className:"flex items-center justify-between mt-6",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",x," to ",l," of ",d," results"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(N,{variant:"outline",size:"sm",onClick:()=>n(u),disabled:!u,children:"Previous"}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>n(h),disabled:!h,children:"Next"})]})]})},as=r=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(Number(r||0)),rs=({roomTypes:r=[]})=>{const[a,i]=c.useState("name"),[x,l]=c.useState("asc"),d=c.useMemo(()=>{const p=[...r],D=x==="asc"?1:-1;return p.sort((Y,ae)=>a==="capacity"?(Number(Y.capacity)-Number(ae.capacity))*D:a==="price_per_night"?(Number(Y.price_per_night)-Number(ae.price_per_night))*D:String(Y.name).localeCompare(String(ae.name))*D)},[r,a,x]),u=p=>{a===p?l(D=>D==="asc"?"desc":"asc"):(i(p),l("asc"))},h=({field:p,children:D,className:Y=""})=>e.jsx(B,{className:`cursor-pointer ${Y}`,onClick:()=>u(p),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:D}),a===p&&e.jsx(Ee,{className:`h-3 w-3 ${x==="asc"?"":"rotate-180"}`})]})}),[n,m]=c.useState(!1),{data:s,setData:y,post:o,processing:j,errors:Q,reset:S,clearErrors:C,setDefaults:I}=he({name:"",capacity:"",price_per_night:""}),ee=()=>{I({name:"",capacity:"",price_per_night:""}),S(),C(),m(!0)},A=p=>{p.preventDefault(),o(route("room-types.store"),{preserveScroll:!0,onSuccess:()=>{S(),m(!1),E.reload({only:["roomTypes"]})}})},[M,T]=c.useState(!1),[q,O]=c.useState(null),{data:ne,setData:H,put:U,processing:R,errors:t,reset:g,clearErrors:w,setDefaults:b}=he({name:"",capacity:"",price_per_night:""}),_=p=>{b({name:"",capacity:"",price_per_night:""}),g(),w(),O(p),H({name:p.name??"",capacity:p.capacity??"",price_per_night:p.price_per_night??""}),T(!0)},de=p=>{p.preventDefault(),q&&U(route("room-types.update",q.id),{preserveScroll:!0,onSuccess:()=>{T(!1),O(null),g(),E.reload({only:["roomTypes"]})}})},[me,se]=c.useState(!1),[te,le]=c.useState(null),xe=p=>{le(p),se(!0)},ue=()=>{te&&E.delete(route("room-types.destroy",te.id),{preserveScroll:!0,onSuccess:()=>{se(!1),le(null),E.reload({only:["roomTypes"]})}})};return c.useEffect(()=>{n||S()},[n]),c.useEffect(()=>{M||(O(null),g())},[M]),e.jsxs("div",{className:"mt-10",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Room Types"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage room type catalog"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs(N,{onClick:ee,className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"})," Add Type"]})})]}),e.jsx("div",{className:"rounded-md border overflow-hidden",children:e.jsxs(De,{children:[e.jsx(Pe,{children:e.jsxs(W,{children:[e.jsx(B,{className:"w-8"}),e.jsx(h,{field:"name",children:"Name"}),e.jsx(h,{field:"capacity",className:"w-40",children:"Capacity"}),e.jsx(h,{field:"price_per_night",className:"w-48",children:"Price/Night"}),e.jsx(B,{className:"w-40 text-right",children:"Actions"})]})}),e.jsx(ke,{children:d.length?d.map(p=>e.jsxs(W,{children:[e.jsx(v,{}),e.jsx(v,{children:e.jsx("span",{className:"font-medium",children:p.name})}),e.jsxs(v,{children:[p.capacity," People"]}),e.jsx(v,{children:as(p.price_per_night)}),e.jsx(v,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(N,{size:"sm",variant:"ghost",onClick:()=>_(p),className:"inline-flex gap-1 bg-secondary text-secondary-foreground",title:"Edit",children:e.jsx(Te,{className:"h-4 w-4"})}),e.jsx(N,{size:"sm",variant:"ghost",className:"inline-flex gap-1 bg-destructive text-destructive-foreground",onClick:()=>xe(p),title:"Delete",children:e.jsx(Re,{className:"h-4 w-4"})})]})})]},p.id)):e.jsx(W,{children:e.jsx(v,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No room types found"})})})]})}),e.jsx(L,{open:n,onOpenChange:m,children:e.jsx(G,{className:"sm:max-w-[425px]",children:e.jsxs("form",{onSubmit:A,children:[e.jsx(z,{children:e.jsx(V,{children:"Add Room Type"})}),e.jsx(ce,{data:s,setData:y,errors:Q}),e.jsxs(ye,{className:"gap-2",children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(N,{type:"submit",disabled:j,children:j?"Saving...":"Save Type"})]})]})})}),e.jsx(L,{open:M,onOpenChange:T,children:e.jsx(G,{className:"sm:max-w-[425px]",children:e.jsxs("form",{onSubmit:de,children:[e.jsx(z,{children:e.jsx(V,{children:"Edit Room Type"})}),e.jsx(ce,{data:ne,setData:H,errors:t}),e.jsxs(ye,{className:"gap-2",children:[e.jsx(N,{type:"button",variant:"outline",onClick:()=>T(!1),children:"Cancel"}),e.jsx(N,{type:"submit",disabled:R,children:R?"Saving...":"Save Changes"})]})]})})}),e.jsx(Oe,{isOpen:me,onOpenChange:se,onConfirm:ue,entityLabel:"Room Type",entityValue:te?.name??""})]})},Ie="https://placehold.co/400x300/e2e8f0/94a3b8?text=No+Image";function ns({images:r,title:a}){return!r||r.length===0?null:e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-sm font-semibold mb-2 text-gray-700",children:a}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:r.map(i=>e.jsx("div",{className:"relative aspect-square rounded-lg overflow-hidden border bg-gray-100",children:e.jsx("img",{src:i.url||Ie,alt:i.caption||"Room image",onError:x=>{x.currentTarget.src=Ie},className:"w-full h-full object-cover"})},i.id))})]})}function ls({open:r,onOpenChange:a,roomMeta:i}){const[x,l]=c.useState(!1),[d,u]=c.useState(""),[h,n]=c.useState([]);return console.log("images",i),c.useEffect(()=>{if(r&&i?.id){l(!0),u("");const m=typeof route=="function"?route("rooms.images",i.id):`/rooms/${i.id}/images`;console.log("Fetching images from:",m),fetch(m).then(async s=>{if(console.log("Response status:",s.status),!s.ok){const y=await s.json().catch(()=>null);throw console.error("Error response:",y),new Error(y?.message||`HTTP ${s.status}: ${s.statusText}`)}return s.json()}).then(s=>{console.log("API Response data:",s),n(s.room_images||[])}).catch(s=>{console.error("Fetch error:",s),u(s.message||"Could not load images.")}).finally(()=>{l(!1)})}},[r,i]),e.jsx(L,{open:r,onOpenChange:a,children:e.jsxs(G,{className:"sm:max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(z,{children:[e.jsxs(V,{children:["Images for Room: ",i?.name||"..."]}),e.jsx(ie,{children:"Review images assigned to this specific room."})]}),e.jsxs("div",{className:"py-4",children:[x&&e.jsx("div",{className:"flex items-center justify-center h-40",children:e.jsx(Me,{className:"h-8 w-8 animate-spin text-primary"})}),d&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-destructive",children:[e.jsx(Je,{className:"h-8 w-8 mb-2"}),e.jsx("span",{className:"font-medium",children:d})]}),!x&&!d&&e.jsxs("div",{children:[e.jsx(ns,{images:h,title:"Specific Room Images"}),h.length===0&&e.jsx("p",{className:"text-center text-gray-500 py-10",children:"No images found for this room."})]})]})]})})}function os(){const{rooms:r,roomTypes:a,filters:i,flash:x}=Be().props,[l,d]=c.useState(i.search||""),[u,h]=c.useState(i.status||"all"),[n,m]=c.useState(i.room_type_id||"all"),[s,y]=c.useState(i.sort_by||"room_number"),[o,j]=c.useState(i.sort_direction||"asc"),[Q,S]=c.useState(!1),[C,I]=c.useState(!1),[ee,A]=c.useState(!1),[M,T]=c.useState(!1),[q,O]=c.useState(!1),[ne,H]=c.useState(null),[U,R]=c.useState(null),[t,g]=c.useState([]),[w,b]=c.useState(!1);c.useEffect(()=>{x?.success&&ve.success(x.success),x?.error&&ve.error(x.error)},[x]),c.useEffect(()=>{const f=setTimeout(()=>_(1),500);return()=>clearTimeout(f)},[l,u,n,s,o]);const _=(f=i.page||1)=>{E.get(route("rooms.index"),{search:l,status:u==="all"?"":u,room_type_id:n==="all"?"":n,sort_by:s,sort_direction:o,page:f},{preserveState:!0,replace:!0})},de=f=>{s===f?j(F=>F==="asc"?"desc":"asc"):(y(f),j("asc"))},me=()=>{b(!1),S(!0)},se=f=>{R(f),I(!0)},te=f=>{R(f),A(!0)},le=f=>{H({id:f.id,name:f.room_number}),O(!0)},xe=()=>S(!1),ue=()=>{I(!1),R(null)},p=()=>{E.delete(route("rooms.destroy",U.id),{onSuccess:()=>{A(!1),R(null)}})},D=()=>{T(!1),E.reload({only:["roomTypes"]})},Y=()=>{d(""),h("all"),m("all"),y("room_number"),j("asc")},ae=f=>g(F=>F.includes(f)?F.filter($=>$!==f):[...F,f]),Fe=f=>{if(!f)return null;const F=new URL(f,window.location.origin),$=new URLSearchParams(F.search);return $.set("search",l),$.set("status",u==="all"?"":u),$.set("room_type_id",n==="all"?"":n),$.set("sort_by",s),$.set("sort_direction",o),`${F.pathname}?${$.toString()}`},$e=f=>b(f);return e.jsxs("div",{className:"container mx-auto py-2 px-4",children:[e.jsxs(oe,{className:"mb-8",children:[e.jsx(Xe,{onAddRoom:me}),e.jsxs(Ne,{children:[e.jsx(Ke,{searchTerm:l,setSearchTerm:d,selectedStatus:u,setSelectedStatus:h,selectedTypeId:n,setSelectedTypeId:m,roomTypes:a,clearFilters:Y}),e.jsx(Qe,{rooms:r.data,expandedRows:t,toggleRow:ae,openEditModal:se,openDeleteModal:te,openImagesModal:le,sortBy:s,sortDirection:o,handleSort:de}),e.jsx(ts,{paginationData:r,buildPaginationUrl:Fe,router:E})]})]}),e.jsx(rs,{roomTypes:a}),e.jsx(L,{open:Q,onOpenChange:S,children:e.jsxs(G,{className:`${w?"sm:max-w-4xl":"sm:max-w-2xl"} max-h-[90vh] overflow-y-auto`,children:[e.jsxs(z,{children:[e.jsx(V,{children:"Create New Room"}),e.jsx(ie,{children:"Add a new room to the hotel. You can create a single room or a range of rooms at once."})]}),e.jsx(Ce,{roomTypes:a,onSuccess:xe,onCancel:()=>S(!1),onModeChange:$e})]})}),e.jsx(L,{open:C,onOpenChange:I,children:e.jsxs(G,{className:"sm:max-w-2xl",children:[e.jsxs(z,{children:[e.jsx(V,{children:"Edit Room"}),e.jsx(ie,{children:"Update the room details. Note: You cannot edit a range of rooms at once."})]}),e.jsx(Ce,{roomTypes:a,initialData:U,onSuccess:ue,onCancel:()=>{I(!1),R(null)}})]})}),e.jsx(Oe,{isOpen:ee,onOpenChange:A,onConfirm:p,room:U}),e.jsx(L,{open:M,onOpenChange:T,children:e.jsxs(G,{className:"sm:max-w-md",children:[e.jsx(z,{children:e.jsx(V,{children:"Add Room Type"})}),e.jsx(ce,{onSuccess:D,onCancel:()=>T(!1)})]})}),e.jsx(ls,{open:q,onOpenChange:O,roomMeta:ne})]})}os.layout=r=>e.jsx(ze,{children:r});export{os as default};
